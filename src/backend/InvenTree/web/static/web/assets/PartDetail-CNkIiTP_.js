import{j as t,aa as T,I as V,r as d,h as k,a9 as ue,G as ie,a4 as E,aJ as L,aK as O,S as G,z as me}from"./vendor-C5fHLTDD.js";import{g as _e,i as e,a as w,U as _,A as p,l as C,M as v,j as Q}from"./index-DX4YmBvQ.js";import{I as be,D as N}from"./ItemDetails-DTEWr5C0.js";import{D as he}from"./DetailsImage-Y3z_v9dS.js";import{T as U}from"./BaseContext-BGXKB9QI.js";import{a as I,p as xe,q as ke,x as fe,I as ee,B as ge,C as je,D as ye,E as ve,G as Ce,j as Te,b as Se,H as Pe,c as Fe,d as Ie,J as we,K as Ae,L as Me,M as Re,f as qe,g as De,h as Ee}from"./ApiForm-Dtyf-xF2.js";import{B as Ne,V as Be,L as Ke,U as Le,A as te,a as Oe,E as Ge,D as Qe}from"./ActionDropdown-C-AjyTLr.js";import{P as Ve}from"./PageDetail-BwkjpKwR.js";import{P as Ue}from"./PanelGroup-CWuySmV8.js";import{P as Xe}from"./PartCategoryTree-DYz_97uS.js";import{N as ze}from"./MarkdownEditor-CY0oiYAG.js";import{e as X,D as z,R as le,B as S,h as ne,N as He,P as We}from"./ColumnRenderers-Dz-jxqgo.js";import{u as Ze}from"./PartForms-FGG79plz.js";import{e as Ye,b as Je}from"./StockForms-yHG_9MvM.js";import{u as A,R as H,a as B,I as M,g as re}from"./InvenTreeTable-LkhQVMZE.js";import{a as W,u as Z,b as Y}from"./UseForm-Btt47jru.js";import{u as $e}from"./UseInstance-rwUPjJ4i.js";import{T as oe,P as ae}from"./Instance-c0njg-mI.js";import{Y as de}from"./YesNoButton-DIAHIY63.js";import{u as J,d as et}from"./DesktopAppView-DlNUv0Ur.js";import{I as tt}from"./IconArrowRight-I69ZJa1E.js";import{I as at}from"./IconCircleCheck-CZpHYTUf.js";import{B as st}from"./BuildOrderTable-DzfedSzv.js";import{A as it}from"./AttachmentTable-AC0GadOO.js";import{A as $}from"./AddItemButton-BjrbTsCx.js";import{P as lt}from"./PartTable-9dbqLQIq.js";import{M as nt}from"./ManufacturerPartTable-DoEr_Phj.js";import{S as rt}from"./SupplierPartTable-DDly2pj6.js";import{S as ot}from"./SalesOrderTable-BQaiujQ9.js";import{S as dt}from"./StockItemTable-DiLjDthM.js";import{I as ct}from"./IconInfoCircle-D5K91YCo.js";import"./ProgressBar-BhbAlmdB.js";import"./StylishText-CD9I8-X7.js";import"./ModelType-C8nSW6qW.js";import"./index-DtVngfXu.js";import"./ActionButton-seel8ZoK.js";import"./notifications-DM-9a7Is.js";import"./IconTrash-KFql82qv.js";import"./IconExternalLink-CDh1KHXW.js";import"./IconQrcode-DcoHpd2K.js";import"./IconEdit-DwKL16RF.js";import"./Placeholder-C1-1kY0o.js";import"./index.es-RSVDxQs2.js";import"./IconChevronDown-DoPmRmuk.js";import"./IconSearch-CKaD9XHL.js";import"./IconRefresh-ClXNAr2V.js";import"./IconFileTypePdf-ST3WfDb7.js";import"./IconPlus-QsNVBJ5N.js";import"./CompanyForms-DiSrilXC.js";import"./IconAt-DPf0GkPm.js";import"./IconAddressBook-DD_FnNjd.js";import"./IconUsers-VfNlX2pM.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var pt=_e("outline","switch-3","IconSwitch3",[["path",{d:"M3 17h2.397a5 5 0 0 0 4.096 -2.133l.177 -.253m3.66 -5.227l.177 -.254a5 5 0 0 1 4.096 -2.133h3.397",key:"svg-0"}],["path",{d:"M18 4l3 3l-3 3",key:"svg-1"}],["path",{d:"M3 7h2.397a5 5 0 0 1 4.096 2.133l4.014 5.734a5 5 0 0 0 4.096 2.133h3.397",key:"svg-2"}],["path",{d:"M18 20l3 -3l-3 -3",key:"svg-3"}]]);function P(s){return t.jsx("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:t.jsx(I,{icon:s})})}function ut({part:s}){return t.jsx("td",{colSpan:2,children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[!s.active&&t.jsx(T,{label:e._({id:"TgUP31"}),children:t.jsx(V,{color:"red",variant:"filled",children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[t.jsx(I,{icon:"inactive",iconProps:{size:19}})," ",t.jsx(U,{id:"NoNwIX"})]})})}),s.template&&t.jsx(T,{label:e._({id:"0iczgN"}),children:P("template")}),s.assembly&&t.jsx(T,{label:e._({id:"DMNUuc"}),children:P("assembly")}),s.component&&t.jsx(T,{label:e._({id:"06p4ek"}),children:P("component")}),s.trackable&&t.jsx(T,{label:e._({id:"kO7b8p"}),children:P("trackable")}),s.purchaseable&&t.jsx(T,{label:e._({id:"JSWE8U"}),children:P("purchaseable")}),s.saleable&&t.jsx(T,{label:e._({id:"CPLZbu"}),children:P("saleable")}),s.virtual&&t.jsx(T,{label:e._({id:"2MwUq+"}),children:t.jsx(V,{color:"yellow",variant:"filled",children:t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[t.jsx(I,{icon:"virtual",iconProps:{size:18}})," ",t.jsx(U,{id:"ksX7Wx"})]})})})]})})}function mt(){return{part:{hidden:!0},sub_part:{filters:{component:!0,virtual:!1}},quantity:{},reference:{},overage:{},note:{},allow_variants:{},inherited:{},consumable:{},optional:{}}}function se(s){let n=s.available_stock;return n+=(s==null?void 0:s.available_substitute_stock)??0,s.allow_variants&&(n+=(s==null?void 0:s.available_variant_stock)??0),n}function _t({partId:s,params:n={}}){const c=w(),b=A("bom"),a=J(),m=d.useMemo(()=>[{accessor:"part",switchable:!1,sortable:!0,render:i=>{let l=i.sub_part_detail,x=[];return i.part!=s&&x.push(t.jsx(k,{children:e._({id:"tCdfmU"})},"different-parent")),l&&t.jsx(X,{value:t.jsx(oe,{src:l.thumbnail||l.image,alt:l.description,text:l.full_name}),extra:x,title:e._({id:"vVRudK"})})}},z({accessor:"sub_part_detail.description"}),le(),{accessor:"quantity",switchable:!1,sortable:!0},{accessor:"substitutes",render:i=>(i.substitutes??[]).length>0?i.length:t.jsx(de,{value:!1})},S({accessor:"optional"}),S({accessor:"consumable"}),S({accessor:"allow_variants"}),S({accessor:"inherited"}),{accessor:"price_range",title:e._({id:"YA4hwj"}),sortable:!1,render:i=>ne(i.pricing_min,i.pricing_max)},{accessor:"available_stock",sortable:!0,render:i=>{let l=[],x=se(i),g=(i==null?void 0:i.on_order)??0,r=(i==null?void 0:i.building)??0,u=x<=0?t.jsx(k,{color:"red",italic:!0,children:e._({id:"AbC1Px"})}):x;return i.external_stock>0&&l.push(t.jsxs(k,{children:[e._({id:"e8fwfT"}),": ",i.external_stock]},"external")),i.available_substitute_stock>0&&l.push(t.jsxs(k,{children:[e._({id:"XTe+lK"}),":"," ",i.available_substitute_stock]},"substitute")),i.allow_variants&&i.available_variant_stock>0&&l.push(t.jsxs(k,{children:[e._({id:"LdvJ9e"}),": ",i.available_variant_stock]},"variant")),g>0&&l.push(t.jsxs(k,{children:[e._({id:"/MB+gl"}),": ",g]},"on_order")),r>0&&l.push(t.jsxs(k,{children:[e._({id:"oZd08v"}),": ",r]},"building")),t.jsx(X,{value:u,extra:l,title:e._({id:"odasNw"})})}},{accessor:"can_build",title:e._({id:"S/9nwz"}),sortable:!1,render:i=>{if(i.consumable)return t.jsx(k,{italic:!0,children:e._({id:"f/GbFw"})});let l=se(i)/i.quantity;return l=Math.trunc(l),t.jsx(k,{color:l<=0?"red":void 0,children:l})}},He()],[s,n]),h=d.useMemo(()=>[{name:"sub_part_trackable",label:e._({id:"SH3bOE"}),description:e._({id:"GnQW79"})},{name:"sub_part_assembly",label:e._({id:"+e3Z9N"}),description:e._({id:"1LYhEA"})},{name:"available_stock",description:e._({id:"Dg4tQl"})},{name:"on_order",description:e._({id:"xfq4ym"})},{name:"validated",description:e._({id:"37tHwV"})},{name:"inherited",description:e._({id:"/8VvXe"})},{name:"optional",description:e._({id:"XHqrSv"})},{name:"consumable",description:e._({id:"66RvWY"})},{name:"has_pricing",label:e._({id:"T43R5B"}),description:e._({id:"Aszrkt"})}],[s,n]),f=d.useCallback(i=>{if(i.part&&i.part!=s)return[{title:e._({id:"aDkF9z"}),onClick:()=>a(`/part/${i.part}/`),icon:t.jsx(tt,{})}];let l=[];return l.push({title:e._({id:"tlXhbF"}),color:"green",hidden:i.validated||!c.hasChangeRole(_.part),icon:t.jsx(at,{})}),l.push({title:e._({id:"Omvn40"}),color:"blue",hidden:!c.hasChangeRole(_.part),icon:t.jsx(pt,{})}),l.push(H({hidden:!c.hasChangeRole(_.part),onClick:()=>{xe({url:p.bom_list,pk:i.pk,title:e._({id:"RqNith"}),fields:mt(),successMessage:e._({id:"AT7M/M"}),onFormSuccess:b.refreshTable})}})),l.push(B({hidden:!c.hasDeleteRole(_.part),onClick:()=>{ke({url:p.bom_list,pk:i.pk,title:e._({id:"1kk0o3"}),successMessage:e._({id:"ZrT5g0"}),onFormSuccess:b.refreshTable,preFormWarning:e._({id:"+d9ARc"})})}})),l},[s,c]);return t.jsx(M,{url:C(p.bom_list),tableState:b,columns:m,props:{params:{...n,part:s,part_detail:!0,sub_part_detail:!0},tableFilters:h,modelType:v.part,rowActions:f}})}function bt({partId:s,params:n={}}){const c=A("usedin"),b=d.useMemo(()=>[{accessor:"part",switchable:!1,sortable:!0,render:m=>t.jsx(ae,{part:m.part_detail})},{accessor:"sub_part",sortable:!0,render:m=>t.jsx(ae,{part:m.sub_part_detail})},{accessor:"quantity",render:m=>m.quantity},le()],[s]),a=d.useMemo(()=>[{name:"inherited",description:e._({id:"/8VvXe"})},{name:"optional",description:e._({id:"XHqrSv"})},{name:"part_active",label:e._({id:"F6pfE9"}),description:e._({id:"v3oiP1"})},{name:"part_trackable",label:e._({id:"y6MnU0"}),description:e._({id:"pvl7N9"})}],[s]);return t.jsx(M,{url:C(p.bom_list),tableState:c,columns:b,props:{params:{...n,uses:s,part_detail:!0,sub_part_detail:!0},tableFilters:a,modelType:v.part}})}function ht({partId:s}){const n=A("part-parameters"),c=w(),b=d.useMemo(()=>[{accessor:"part",sortable:!0,render:r=>We(r==null?void 0:r.part_detail)},{accessor:"part_detail.IPN",sortable:!1,switchable:!0},{accessor:"template_detail.name",switchable:!1,sortable:!0,ordering:"name",render:r=>{var o;let u=String(s)!=String(r.part);return t.jsx(k,{italic:u,children:(o=r.template_detail)==null?void 0:o.name})}},z({accessor:"template_detail.description"}),{accessor:"data",switchable:!1,sortable:!0,render:r=>{let u=r.template_detail;if(u!=null&&u.checkbox)return t.jsx(de,{value:r.data});let o=[];return u.units&&r.data_numeric&&r.data_numeric!=r.data&&o.push(`${r.data_numeric} [${u.units}]`),t.jsx(X,{value:r.data,extra:o,title:e._({id:"Y0ne3N"})})}},{accessor:"template_detail.units",ordering:"units",sortable:!0}],[s]),a=d.useMemo(()=>({part:{},template:{},data:{}}),[]),m=W({url:p.part_parameter_list,title:e._({id:"CzIiuH"}),fields:a,initialData:{part:s},onFormSuccess:n.refreshTable}),[h,f]=d.useState(void 0),i=Z({url:p.part_parameter_list,pk:h,title:e._({id:"ZqLOh/"}),fields:a,onFormSuccess:n.refreshTable}),l=Y({url:p.part_parameter_list,pk:h,title:e._({id:"uuJqm+"}),onFormSuccess:n.refreshTable}),x=d.useCallback(r=>String(s)!=String(r.part)?[]:[H({tooltip:e._({id:"ZqLOh/"}),hidden:!c.hasChangeRole(_.part),onClick:()=>{f(r.pk),i.open()}}),B({tooltip:e._({id:"uuJqm+"}),hidden:!c.hasDeleteRole(_.part),onClick:()=>{f(r.pk),l.open()}})],[s,c]),g=d.useMemo(()=>[t.jsx($,{hidden:!c.hasAddRole(_.part),tooltip:e._({id:"2tuwGz"}),onClick:()=>m.open()})],[c]);return t.jsxs(t.Fragment,{children:[m.modal,i.modal,l.modal,t.jsx(M,{url:C(p.part_parameter_list),tableState:n,columns:b,props:{rowActions:x,tableActions:g,tableFilters:[{name:"include_variants",label:e._({id:"/g9i/Z"}),type:"boolean"}],params:{part:s,template_detail:!0,part_detail:!0}}})]})}function xt({partId:s}){const n=A("part-test-template"),c=w(),b=J(),a=d.useMemo(()=>[{accessor:"test_name",switchable:!1,sortable:!0,render:o=>t.jsx(k,{weight:o.required&&700,color:o.enabled?void 0:"red",children:o.test_name})},{accessor:"results",switchable:!0,sortable:!0,title:e._({id:"kx0s+n"}),render:o=>o.results||t.jsx(V,{color:"blue",children:e._({id:"MA3x23"})})},z({switchable:!1}),S({accessor:"enabled"}),S({accessor:"required"}),S({accessor:"requires_value"}),S({accessor:"requires_attachment"})],[s]),m=d.useMemo(()=>[{name:"required",description:e._({id:"pgdOa+"})},{name:"enabled",description:e._({id:"E4Q3+2"})},{name:"requires_value",description:e._({id:"loHk6k"})},{name:"requires_attachment",description:e._({id:"ufV8ON"})},{name:"include_inherited",label:e._({id:"R9N/8P"}),description:e._({id:"e6bd4c"})},{name:"has_results",label:e._({id:"6pnRgI"}),description:e._({id:"+ZdPFq"})}],[]),h=d.useMemo(()=>({part:{hidden:!c.isStaff()},test_name:{},description:{},required:{},requires_value:{},requires_attachment:{},enabled:{}}),[c]),f=W({url:p.part_test_template_list,title:e._({id:"c+EQoO"}),fields:h,initialData:{part:s},onFormSuccess:n.refreshTable}),[i,l]=d.useState(-1),x=Z({url:p.part_test_template_list,pk:i,title:e._({id:"2aEufW"}),fields:h,onFormSuccess:o=>n.updateRecord(o)}),g=Y({url:p.part_test_template_list,pk:i,title:e._({id:"ol4QKg"}),preFormContent:t.jsx(ue,{color:"red",title:e._({id:"jIZttH"}),children:t.jsx(k,{children:t.jsx(U,{id:"E87VhQ"})})}),onFormSuccess:n.refreshTable}),r=d.useCallback(o=>{const R=c.hasChangeRole(_.part),K=c.hasDeleteRole(_.part);return o.part!=s?[]:[H({hidden:!R,onClick:()=>{l(o.pk),x.open()}}),B({hidden:!K,onClick:()=>{l(o.pk),g.open()}})]},[c,s]),u=d.useMemo(()=>{let o=c.hasAddRole(_.part);return[t.jsx($,{tooltip:e._({id:"c+EQoO"}),onClick:()=>f.open(),hidden:!o})]},[c]);return t.jsxs(t.Fragment,{children:[f.modal,x.modal,g.modal,t.jsx(M,{url:C(p.part_test_template_list),tableState:n,columns:a,props:{params:{part:s,part_detail:!0},tableFilters:m,tableActions:u,rowActions:r,onRowClick:o=>{o.part&&o.part!=s&&b(re(v.part,o.part))}}})]})}function kt({partId:s}){const n=d.useMemo(()=>[{name:"active",label:e._({id:"F6pfE9"}),description:e._({id:"rvLCOc"})},{name:"template",label:e._({id:"/K2CvV"}),description:e._({id:"GdgCV2"})},{name:"virtual",label:e._({id:"ksX7Wx"}),description:e._({id:"83ib20"})},{name:"trackable",label:e._({id:"y6MnU0"}),description:e._({id:"7VJ4Si"})}],[]);return t.jsx(lt,{props:{enableDownload:!1,tableFilters:n,params:{ancestor:s}}})}function ft({partId:s}){const n=A("relatedparts"),c=J(),b=w(),a=d.useMemo(()=>{function r(u){return u.part_1==s?u.part_2_detail:u.part_1_detail}return[{accessor:"part",title:e._({id:"vgP+9p"}),render:u=>{let o=r(u);return t.jsxs(ie,{noWrap:!0,position:"left",onClick:()=>{c(`/part/${o.pk}/`)},children:[t.jsx(oe,{src:o.thumbnail||o.image}),t.jsx(k,{children:o.name})]})}},{accessor:"description",title:e._({id:"Nu4oKW"}),ellipsis:!0,render:u=>r(u).description}]},[s]),m=d.useMemo(()=>({part_1:{hidden:!0},part_2:{}}),[]),h=W({url:p.related_part_list,title:e._({id:"K0+pq1"}),fields:m,initialData:{part_1:s},onFormSuccess:n.refreshTable}),[f,i]=d.useState(void 0),l=Y({url:p.related_part_list,pk:f,title:e._({id:"/kFxhJ"}),onFormSuccess:n.refreshTable}),x=d.useMemo(()=>[t.jsx($,{tooltip:e._({id:"xG+5dj"}),hidden:!b.hasAddRole(_.part),onClick:()=>h.open()})],[b]),g=d.useCallback(r=>[B({hidden:!b.hasDeleteRole(_.part),onClick:()=>{i(r.pk),l.open()}})],[b]);return t.jsxs(t.Fragment,{children:[h.modal,l.modal,t.jsx(M,{url:C(p.related_part_list),tableState:n,columns:a,props:{params:{part:s,category_detail:!0},rowActions:g,tableActions:x}})]})}function ka(){const{id:s}=et(),n=w(),[c,b]=d.useState(!1),{instance:a,refreshInstance:m,instanceQuery:h}=$e({endpoint:p.part_list,pk:s,params:{path_detail:!0},refetchOnMount:!0}),f=d.useMemo(()=>{if(h.isFetching)return t.jsx(E,{});let q=[{type:"string",name:"name",label:e._({id:"6YtxFj"}),icon:"part",copy:!0},{type:"string",name:"description",label:e._({id:"Nu4oKW"}),copy:!0},{type:"link",name:"variant_of",label:e._({id:"ji2aTl"}),model:v.part,hidden:!a.variant_of},{type:"link",name:"category",label:e._({id:"K7tIrx"}),model:v.partcategory},{type:"link",name:"default_location",label:e._({id:"xuaXgj"}),model:v.stocklocation,hidden:!a.default_location},{type:"link",name:"category_default_location",label:e._({id:"6uSImw"}),model:v.stocklocation,hidden:a.default_location||!a.category_default_location},{type:"string",name:"IPN",label:e._({id:"3wXEsN"}),copy:!0,hidden:!a.IPN},{type:"string",name:"revision",label:e._({id:"6LTyxl"}),copy:!0,hidden:!a.revision},{type:"string",name:"units",label:e._({id:"QrhaVg"}),copy:!0,hidden:!a.units},{type:"string",name:"keywords",label:e._({id:"/n/HCO"}),copy:!0,hidden:!a.keywords},{type:"link",name:"link",label:e._({id:"yzF66j"}),external:!0,copy:!0,hidden:!a.link}],ce=[{type:"string",name:"unallocated_stock",unit:!0,label:e._({id:"oGd3rK"})},{type:"string",name:"total_in_stock",unit:!0,label:e._({id:"zn38D/"})},{type:"string",name:"minimum_stock",unit:!0,label:e._({id:"3K8S+7"}),hidden:a.minimum_stock<=0},{type:"string",name:"ordering",label:e._({id:"/MB+gl"}),unit:!0,hidden:a.ordering<=0},{type:"progressbar",name:"allocated_to_build_orders",total:a.required_for_build_orders,progress:a.allocated_to_build_orders,label:e._({id:"hHWm3x"}),hidden:!a.assembly||a.allocated_to_build_orders<=0&&a.required_for_build_orders<=0},{type:"progressbar",name:"allocated_to_sales_orders",total:a.required_for_sales_orders,progress:a.allocated_to_sales_orders,label:e._({id:"I4qXcg"}),hidden:!a.salable||a.allocated_to_sales_orders<=0&&a.required_for_sales_orders<=0},{type:"string",name:"can_build",unit:!0,label:e._({id:"S/9nwz"}),hidden:!a.assembly},{type:"string",name:"building",unit:!0,label:e._({id:"oZd08v"}),hidden:!a.assembly}],pe=[{type:"boolean",name:"active",label:e._({id:"F6pfE9"})},{type:"boolean",name:"template",label:e._({id:"0ceRuG"})},{type:"boolean",name:"assembly",label:e._({id:"+e3Z9N"})},{type:"boolean",name:"component",label:e._({id:"kux4zT"})},{type:"boolean",name:"trackable",label:e._({id:"SH3bOE"})},{type:"boolean",name:"purchaseable",label:e._({id:"f9RadV"})},{type:"boolean",name:"saleable",label:e._({id:"HqVuYd"})},{type:"boolean",name:"virtual",label:e._({id:"PF44mc"})}],D=[{type:"string",name:"creation_date",label:e._({id:"FNcMGM"})},{type:"string",name:"creation_user",label:e._({id:"egTba/"}),badge:"user",icon:"user"},{type:"string",name:"responsible",label:e._({id:"XQACoK"}),badge:"owner",hidden:!a.responsible},{type:"link",name:"default_supplier",label:e._({id:"WpC0X0"}),model:v.supplierpart,hidden:!a.default_supplier}];return s&&D.push({type:"string",name:"pricing",label:e._({id:"YA4hwj"}),value_formatter:()=>{const{data:j}=L({queryKey:["pricing",s],queryFn:async()=>{const F=C(p.part_pricing_get,null,{id:s});return Q.get(F).then(y=>{switch(y.status){case 200:return y.data;default:return null}}).catch(()=>null)}});return`${ne(j.overall_min,j.overall_max)}${a.units&&" / "+a.units}`}}),s&&a.last_stocktake&&(D.push({type:"string",name:"stocktake",label:e._({id:"whZ7zT"}),unit:!0,value_formatter:()=>{const{data:j}=L({queryKey:["stocktake",s],queryFn:async()=>{const F=C(p.part_stocktake_list);return Q.get(F,{params:{part:s,ordering:"date"}}).then(y=>{switch(y.status){case 200:return y.data[y.data.length-1];default:return null}}).catch(()=>null)}});return j.quantity?`${j.quantity} (${j.date})`:"-"}}),D.push({type:"string",name:"stocktake_user",label:e._({id:"TF+TDw"}),badge:"user",icon:"user",value_formatter:()=>{const{data:j}=L({queryKey:["stocktake",s],queryFn:async()=>{const F=C(p.part_stocktake_list);return Q.get(F,{params:{part:s,ordering:"date"}}).then(y=>{switch(y.status){case 200:return y.data[y.data.length-1];default:return null}}).catch(()=>null)}});return j==null?void 0:j.user}})),t.jsxs(be,{children:[t.jsxs(O,{children:[t.jsx(O.Col,{span:4,children:t.jsx(he,{appRole:_.part,imageActions:{selectExisting:!0,uploadFile:!0,deleteFile:!0},src:a.image,apiPath:C(p.part_list,a.pk),refresh:m,pk:a.pk})}),t.jsx(O.Col,{span:8,children:t.jsxs(G,{spacing:"xs",children:[t.jsx(ut,{part:a}),t.jsx(N,{fields:q,item:a})]})})]}),t.jsx(N,{fields:ce,item:a}),t.jsx(N,{fields:pe,item:a}),t.jsx(N,{fields:D,item:a})]})},[a,h]),i=d.useMemo(()=>[{name:"details",label:e._({id:"sQRZ1+"}),icon:t.jsx(ct,{}),content:f},{name:"parameters",label:e._({id:"F18WP3"}),icon:t.jsx(fe,{}),content:t.jsx(ht,{partId:s??-1})},{name:"stock",label:e._({id:"blbbPS"}),icon:t.jsx(ee,{}),content:a.pk&&t.jsx(dt,{params:{part:a.pk}})},{name:"variants",label:e._({id:"SDRhYQ"}),icon:t.jsx(ge,{}),hidden:!a.is_template,content:t.jsx(kt,{partId:String(s)})},{name:"allocations",label:e._({id:"KwhnxF"}),icon:t.jsx(je,{}),hidden:!a.component&&!a.salable},{name:"bom",label:e._({id:"/637F4"}),icon:t.jsx(ye,{}),hidden:!a.assembly,content:t.jsx(_t,{partId:a.pk??-1})},{name:"builds",label:e._({id:"RCVhIP"}),icon:t.jsx(ve,{}),hidden:!a.assembly,content:a!=null&&a.pk?t.jsx(st,{partId:a.pk}):t.jsx(E,{})},{name:"used_in",label:e._({id:"5M5Kdm"}),icon:t.jsx(Ce,{}),hidden:!a.component,content:t.jsx(bt,{partId:a.pk??-1})},{name:"pricing",label:e._({id:"aHCEmh"}),icon:t.jsx(Te,{})},{name:"manufacturers",label:e._({id:"E0ub4Q"}),icon:t.jsx(Se,{}),hidden:!a.purchaseable,content:a.pk&&t.jsx(nt,{params:{part:a.pk}})},{name:"suppliers",label:e._({id:"9RecCt"}),icon:t.jsx(Pe,{}),hidden:!a.purchaseable,content:a.pk&&t.jsx(rt,{params:{part:a.pk}})},{name:"purchase_orders",label:e._({id:"85Yvr2"}),icon:t.jsx(Fe,{}),hidden:!a.purchaseable},{name:"sales_orders",label:e._({id:"B1TL+X"}),icon:t.jsx(Ie,{}),hidden:!a.salable,content:a.pk?t.jsx(ot,{partId:a.pk}):t.jsx(E,{})},{name:"scheduling",label:e._({id:"DbZMYM"}),icon:t.jsx(we,{})},{name:"stocktake",label:e._({id:"d5IWFK"}),icon:t.jsx(Ae,{})},{name:"test_templates",label:e._({id:"eeXE8u"}),icon:t.jsx(Me,{}),hidden:!a.trackable,content:a!=null&&a.pk?t.jsx(xt,{partId:a==null?void 0:a.pk}):t.jsx(E,{})},{name:"related_parts",label:e._({id:"AAoGm5"}),icon:t.jsx(Re,{}),content:t.jsx(ft,{partId:a.pk??-1})},{name:"attachments",label:e._({id:"w/Sphq"}),icon:t.jsx(qe,{}),content:t.jsx(it,{endpoint:p.part_attachment_list,model:"part",pk:a.pk??-1})},{name:"notes",label:e._({id:"1DBGsz"}),icon:t.jsx(De,{}),content:t.jsx(ze,{url:C(p.part_list,a.pk),data:a.notes??"",allowEdit:!0})}],[s,a]),l=d.useMemo(()=>[{name:e._({id:"pmRbKZ"}),url:"/part"},...(a.category_path??[]).map(q=>({name:q.name,url:re(v.partcategory,q.pk)}))],[a]),x=d.useMemo(()=>t.jsx(ie,{spacing:"xs",noWrap:!0,children:t.jsx(G,{spacing:"xs",children:t.jsxs(k,{children:["Stock: ",a.in_stock]})})}),[a,s]),g=Ze({create:!1}),r=Z({url:p.part_list,pk:a.pk,title:e._({id:"enG3o5"}),fields:g,onFormSuccess:m}),u=d.useMemo(()=>({pk:a.pk,model:v.part,refresh:m}),[a]),o=Ye(u),R=Je(u),K=d.useMemo(()=>[t.jsx(Ne,{actions:[Be({}),Ke({hidden:a==null?void 0:a.barcode_hash}),Le({hidden:!(a!=null&&a.barcode_hash)})]}),t.jsx(te,{tooltip:e._({id:"bbA1t1"}),icon:t.jsx(ee,{}),actions:[{icon:t.jsx(I,{icon:"stocktake",iconProps:{color:"blue"}}),name:e._({id:"n/p2QJ"}),tooltip:e._({id:"4Qpffa"}),hidden:!n.hasChangeRole(_.stock),onClick:()=>{a.pk&&o.open()}},{icon:t.jsx(I,{icon:"transfer",iconProps:{color:"blue"}}),name:e._({id:"9efe+k"}),tooltip:e._({id:"tnr8CD"}),hidden:!n.hasChangeRole(_.stock),onClick:()=>{a.pk&&R.open()}}]},"stock"),t.jsx(te,{tooltip:e._({id:"loB51L"}),icon:t.jsx(Ee,{}),actions:[Oe({hidden:!n.hasAddRole(_.part)}),Ge({hidden:!n.hasChangeRole(_.part),onClick:()=>r.open()}),Qe({hidden:(a==null?void 0:a.active)||!n.hasDeleteRole(_.part)})]},"part")],[s,a,n]);return t.jsxs(t.Fragment,{children:[r.modal,t.jsxs(G,{spacing:"xs",children:[t.jsx(me,{visible:h.isFetching}),t.jsx(Xe,{opened:c,onClose:()=>{b(!1)},selectedCategory:a==null?void 0:a.category}),t.jsx(Ve,{title:e._({id:"vgP+9p"})+": "+a.full_name,subtitle:a.description,imageUrl:a.image,detail:x,breadcrumbs:l,breadcrumbAction:()=>{b(!0)},actions:K}),t.jsx(Ue,{pageKey:"part",panels:i}),R.modal,o.modal]})]})}export{ka as default};
