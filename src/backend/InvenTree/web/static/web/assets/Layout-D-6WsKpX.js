import{r as g,j as e,a1 as y,A as L,g as N,G as f,a2 as j,a3 as G,h as S,a4 as K,a5 as ne,a6 as U,H as Y,D as je,a7 as X,u as me,a8 as ie,T as V,Y as ge,K as M,F as $,S as D,z as fe,a9 as Q,aa as ke,ab as ve,ac as Se,ad as te,C as _e,L as ye,ae as we,af as B,ag as be,ah as Z}from"./vendor-C5fHLTDD.js";import{I as b,S as Re}from"./StylishText-CD9I8-X7.js";import{g as R,i as h,a as oe,m as Ie,I as Me,u as Ce,h as Ee,l as T,A as O,j as H,c as Ve,M as v,U as m,d as ze}from"./index-DX4YmBvQ.js";import{f as Le,n as De,a as Te,b as Oe}from"./links-BlATihB1.js";import{N as He,u as A,L as z,a as Ne,O as Ae,b as Pe,c as We}from"./DesktopAppView-DlNUv0Ur.js";import{o as Fe,T as o,I as Ue}from"./BaseContext-BGXKB9QI.js";import{I as Be}from"./IconQrcode-DcoHpd2K.js";import{I as Ze}from"./IconChevronDown-DoPmRmuk.js";import{D as le}from"./DocTooltip-BYA2RvhP.js";import{P as Ke}from"./Placeholder-C1-1kY0o.js";import{I as Qe}from"./IconBellCheck-CsXrvpz0.js";import{R as Je}from"./Instance-c0njg-mI.js";import{M as ce}from"./ModelType-C8nSW6qW.js";import{I as J}from"./IconSearch-CKaD9XHL.js";import{I as qe}from"./IconRefresh-ClXNAr2V.js";import{I as Ge}from"./IconAlertCircle-C-1MzrG3.js";import"./IconInfoCircle-D5K91YCo.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ye=R("outline","backspace","IconBackspace",[["path",{d:"M20 6a1 1 0 0 1 1 1v10a1 1 0 0 1 -1 1h-11l-5 -5a1.5 1.5 0 0 1 0 -2l5 -5z",key:"svg-0"}],["path",{d:"M12 10l4 4m0 -4l-4 4",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var Xe=R("outline","bell-plus","IconBellPlus",[["path",{d:"M12.5 17h-8.5a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6a2 2 0 1 1 4 0a7 7 0 0 1 4 6v1",key:"svg-0"}],["path",{d:"M9 17v1a3 3 0 0 0 3.51 2.957",key:"svg-1"}],["path",{d:"M16 19h6",key:"svg-2"}],["path",{d:"M19 16v6",key:"svg-3"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=R("outline","bell","IconBell",[["path",{d:"M10 5a2 2 0 1 1 4 0a7 7 0 0 1 4 6v3a4 4 0 0 0 2 3h-16a4 4 0 0 0 2 -3v-3a7 7 0 0 1 4 -6",key:"svg-0"}],["path",{d:"M9 17v1a3 3 0 0 0 6 0v-1",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var es=R("outline","layout-sidebar","IconLayoutSidebar",[["path",{d:"M4 4m0 2a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z",key:"svg-0"}],["path",{d:"M9 4l0 16",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ss=R("outline","logout","IconLogout",[["path",{d:"M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2",key:"svg-0"}],["path",{d:"M9 12h12l-3 -3",key:"svg-1"}],["path",{d:"M18 15l3 -3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var de=R("outline","settings","IconSettings",[["path",{d:"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z",key:"svg-0"}],["path",{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ts=R("outline","user-bolt","IconUserBolt",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4c.267 0 .529 .026 .781 .076",key:"svg-1"}],["path",{d:"M19 16l-2 3h4l-2 3",key:"svg-2"}]]);/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var rs=R("outline","user-cog","IconUserCog",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h2.5",key:"svg-1"}],["path",{d:"M19.001 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-2"}],["path",{d:"M19.001 15.5v1.5",key:"svg-3"}],["path",{d:"M19.001 21v1.5",key:"svg-4"}],["path",{d:"M22.032 17.25l-1.299 .75",key:"svg-5"}],["path",{d:"M17.27 20l-1.3 .75",key:"svg-6"}],["path",{d:"M15.97 17.25l1.3 .75",key:"svg-7"}],["path",{d:"M20.733 20l1.3 .75",key:"svg-8"}]]);const as="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='400'%20height='400'%3e%3cg%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%3e%3cpath%20fill='%23ddbc91'%20d='M200%20199.906v193.196l166.305-96.016V103.139Z'/%3e%3cpath%20fill='%23d9b383'%20d='M200%20199.906v193.196L33.695%20297.086V103.139Z'/%3e%3cpath%20fill='%23ddbc91'%20d='M366.305%20103.139%20200%20199.906%2033.695%20103.14%20200%206.899z'/%3e%3cg%20fill='%23f3f4e4'%3e%3cpath%20d='M75.27%20127.109v145.46L200%20344.583l124.73-72.012V127.109L200%20199.684Z'/%3e%3cpath%20d='M324.73%20127.11%20200%20199.684%2075.27%20127.109%20200%2054.93Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20d='M200%2054.929v144.756L75.27%20272.569V127.11z'/%3e%3cpath%20fill='%23eaeccf'%20d='M200%2054.929v144.756l124.73%2072.884V127.11z'/%3e%3cpath%20fill='%2390a8d8'%20d='M200%20199.901V296.5l83.153-48.008v-96.973zm0%200V296.5l-83.153-48.008v-96.973zm83.153-48.383L200%20199.9l-83.153-48.383L200%20103.398Z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20443.959v216.54l186.4-107.618V335.499Zm0%200v216.54l-186.4-107.618V335.499Z'/%3e%3cpath%20d='m-360.266%20335.499-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%3e%3cpath%20d='M-546.667%20227.419v216.54l186.4-107.619V118.96Zm0%200v216.54l-186.4-107.619V118.96Z'/%3e%3cpath%20d='m-360.266%20118.959-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3c/g%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667%2010.879v216.54l186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23d9b383'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.676'%20d='M-546.667%2010.879v216.54l-186.4-107.619V-97.58Z'/%3e%3cpath%20fill='%23ddbc91'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='m-360.266-97.581-186.4%20108.46-186.401-108.46%20186.4-107.87z'/%3e%3cg%20fill='%23f3f4e4'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='1.058'%3e%3cpath%20stroke-width='3'%20d='M-686.466-70.715V92.321l139.798%2080.714%20139.801-80.714V-70.715l-139.8%2081.346z'/%3e%3cpath%20stroke-width='2.999'%20d='m-406.866-70.715-139.8%2081.345-139.801-81.345%20139.8-80.902Z'/%3e%3c/g%3e%3cpath%20fill='%23d9dbbc'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l-139.8%2081.692V-70.715z'/%3e%3cpath%20fill='%23eaeccf'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='3'%20d='M-546.667-151.617V10.63l139.8%2081.692V-70.715z'/%3e%3cg%20fill='%2390a8d8'%20stroke='%23000'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke-width='2.999'%3e%3cpath%20d='M-546.667%2010.873v108.27l93.2-53.81v-108.69zm0%200v108.27l-93.2-53.81v-108.69z'/%3e%3cpath%20d='m-453.466-43.357-93.2%2054.23-93.201-54.23%2093.2-53.935Z'/%3e%3c/g%3e%3cpath%20fill='none'%20d='M-787.948-253.366h482.56v946.733h-482.56z'/%3e%3c/svg%3e",ns=g.forwardRef((s,n)=>e.jsx("div",{ref:n,...s,children:e.jsx(He,{to:"/",children:e.jsx(y,{size:28,children:e.jsx(he,{})})})})),he=()=>e.jsx("img",{src:as,alt:h._({id:"DVAy0b"}),height:28});function is(){const{classes:s}=b(),n=Le.map(t=>e.jsx(L,{color:"dimmed",href:t.link,onClick:r=>r.preventDefault(),size:"sm",children:t.label},t.key));return e.jsx("div",{className:s.layoutFooter,children:e.jsxs(N,{className:s.layoutFooterInner,size:"100%",children:[e.jsx(ns,{}),e.jsx(f,{className:s.layoutFooterLinks,children:n})]})})}function os(){return e.jsx(y,{onClick:()=>Fe({modal:"qr",title:h._({id:"XDwkfO"}),innerProps:{}}),children:e.jsx(Be,{})})}function ls(){var a,u,k;const s=A(),{classes:n,theme:t}=b(),r=oe();return e.jsxs(j,{width:260,position:"bottom-end",children:[e.jsx(j.Target,{children:e.jsx(G,{className:n.layoutHeaderUser,children:e.jsxs(f,{spacing:7,children:[e.jsx(S,{weight:500,size:"sm",sx:{lineHeight:1},mr:3,children:r.username()?r.username():e.jsx(K,{height:20,width:40,radius:t.defaultRadius})}),e.jsx(Ze,{})]})})}),e.jsxs(j.Dropdown,{children:[e.jsx(j.Label,{children:e.jsx(o,{id:"Tz0i8g"})}),e.jsx(j.Item,{icon:e.jsx(rs,{}),component:z,to:"/settings/user",children:e.jsx(o,{id:"T3FM0r"})}),((a=r.user)==null?void 0:a.is_staff)&&e.jsx(j.Item,{icon:e.jsx(de,{}),component:z,to:"/settings/system",children:e.jsx(o,{id:"zNkWa6"})}),((u=r.user)==null?void 0:u.is_staff)&&e.jsx(j.Divider,{}),((k=r.user)==null?void 0:k.is_staff)&&e.jsx(j.Item,{icon:e.jsx(ts,{}),component:z,to:"/settings/admin",children:e.jsx(o,{id:"uTLn08"})}),e.jsx(j.Divider,{}),e.jsx(j.Item,{icon:e.jsx(ss,{}),onClick:()=>{Ie(s)},children:e.jsx(o,{id:"nOhz3x"})})]})]})}const ee=[{id:"home",text:e.jsx(o,{id:"i0qMbr"}),link:"/",highlight:!0},{id:"profile",text:e.jsx(o,{id:"T3FM0r"}),link:"/settings/user",doctext:e.jsx(o,{id:"CFYxhi"})},{id:"scan",text:e.jsx(o,{id:"CMQ09J"}),link:"/scan",doctext:e.jsx(o,{id:"PrR19h"}),highlight:!0},{id:"dashboard",text:e.jsx(o,{id:"7p5kLi"}),link:"/dashboard"},{id:"parts",text:e.jsx(o,{id:"pmRbKZ"}),link:"/part/"},{id:"stock",text:e.jsx(o,{id:"blbbPS"}),link:"/stock"},{id:"build",text:e.jsx(o,{id:"iSiFYa"}),link:"/build/"},{id:"purchasing",text:e.jsx(o,{id:"UOTpFa"}),link:"/purchasing/"},{id:"sales",text:e.jsx(o,{id:"mUv9U4"}),link:"/sales/"},{id:"settings-system",text:e.jsx(o,{id:"zNkWa6"}),link:"/settings/system"},{id:"settings-admin",text:e.jsx(o,{id:"uTLn08"}),link:"/settings/admin"}];Me&&ee.push({id:"playground",text:e.jsx(o,{id:"0LrFTO"}),link:"/playground",highlight:!0});function cs({item:s,children:n}){return s.doctext!==void 0?e.jsx(le,{text:s.doctext,detail:s==null?void 0:s.docdetail,link:s==null?void 0:s.doclink,docchildren:s==null?void 0:s.docchildren,children:n},s.id):e.jsx(e.Fragment,{children:n})}function q({links:s,highlighted:n}){const{classes:t}=b();n=n||!1;const r=s.filter(a=>!n||a.highlight===!0);return e.jsx(ne,{cols:2,spacing:0,children:r.map(a=>e.jsx(cs,{item:a,children:e.jsx(G,{className:t.subLink,component:z,to:a.link,p:0,children:e.jsx(S,{size:"sm",fw:500,children:a.text})})},a.id))})}function ds({openDrawer:s}){const{classes:n,theme:t}=b(),[r,a]=Ce(i=>[i.hostKey,i.hostList]),[u]=Ee(i=>[i.server.instance]),[k,_]=g.useState();return g.useEffect(()=>{var i;r&&a[r]&&_((i=a[r])==null?void 0:i.name)},[r]),e.jsxs(U,{width:600,openDelay:300,position:"bottom",shadow:"md",withinPortal:!0,children:[e.jsx(U.Target,{children:e.jsx(G,{onClick:()=>s(),"aria-label":"Homenav",children:e.jsx(he,{})})}),e.jsxs(U.Dropdown,{sx:{overflow:"hidden"},children:[e.jsxs(f,{position:"apart",px:"md",children:[e.jsx(y,{onClick:s,onMouseOver:s,title:h._({id:"rmlxV1"}),children:e.jsx(es,{})}),e.jsxs(f,{spacing:"xs",children:[k||e.jsx(K,{height:20,width:40,radius:t.defaultRadius})," ","|"," ",u||e.jsx(K,{height:20,width:40,radius:t.defaultRadius})]}),e.jsx(L,{href:"#",fz:"xs",onClick:s,children:e.jsx(o,{id:"N6Pxr9"})})]}),e.jsx(Y,{my:"sm",mx:"-md",color:t.colorScheme==="dark"?"dark.5":"gray.1"}),e.jsx(q,{links:ee,highlighted:!0}),e.jsx("div",{className:n.headerDropdownFooter,children:e.jsxs(f,{position:"apart",children:[e.jsxs("div",{children:[e.jsx(S,{fw:500,fz:"sm",children:e.jsx(o,{id:"ZDIydz"})}),e.jsx(S,{size:"xs",color:"dimmed",children:e.jsx(o,{id:"BQDL+H"})})]}),e.jsx(je,{variant:"default",children:e.jsx(o,{id:"ZDIydz"})})]})})]})]})}function re({links:s}){const n=({link:t})=>{const r=e.jsx(S,{size:"sm",fw:500,children:t.title}),a=({children:u})=>t.link?e.jsx(L,{href:t.link,children:u},t.id):t.action?e.jsx(L,{component:"button",type:"button",onClick:t.action,children:u}):(console.log("Neither link nor action found for link:",t),u);return e.jsx(a,{children:t.placeholder?e.jsxs(f,{children:[r,e.jsx(Ke,{})]}):r})};return e.jsx(ne,{cols:2,spacing:0,children:s.map(t=>e.jsx(le,{text:t.description,children:e.jsx(n,{link:t})},t.id))})}const ae=[];function hs({opened:s,close:n}){const{classes:t}=b();return e.jsx(X,{opened:s,onClose:n,overlayProps:{opacity:.5,blur:4},withCloseButton:!1,classNames:{body:t.navigationDrawer},children:e.jsx(us,{})})}function us(){const{classes:s}=b(),[n,t]=g.useState(0),r=g.useRef(null),{height:a}=me();return g.useEffect(()=>{r.current!=null&&t(a-r.current.clientHeight-65)}),e.jsxs(ie,{direction:"column",mih:"100vh",p:16,children:[e.jsx(V,{order:3,children:h._({id:"UxKoFf"})}),e.jsx(N,{className:s.layoutContent,p:0,children:e.jsxs(ge,{h:n,type:"always",offsetScrollbars:!0,children:[e.jsx(V,{order:5,children:h._({id:"wRR604"})}),e.jsx(q,{links:ee}),e.jsx(M,{h:"md"}),ae.length>0?e.jsxs(e.Fragment,{children:[e.jsx(V,{order:5,children:h._({id:"ohUJJM"})}),e.jsx(q,{links:ae})]}):e.jsx(e.Fragment,{})]})}),e.jsxs("div",{ref:r,children:[e.jsx(M,{h:"md"}),e.jsx(V,{order:5,children:h._({id:"TvY/XA"})}),e.jsx(re,{links:De}),e.jsx(M,{h:"md"}),e.jsx(V,{order:5,children:h._({id:"uyJsf6"})}),e.jsx(re,{links:Te})]})]})}function xs({opened:s,onClose:n}){var a,u,k,_;const t=A(),r=$({enabled:s,queryKey:["notifications",s],queryFn:async()=>H.get(T(O.notifications_list),{params:{read:!1,limit:10}}).then(i=>i.data).catch(i=>i),refetchOnMount:!1,refetchOnWindowFocus:!1});return e.jsx(X,{opened:s,size:"md",position:"right",onClose:n,withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(f,{position:"apart",noWrap:!0,children:[e.jsx(Re,{size:"lg",children:h._({id:"iDNBZe"})}),e.jsx(y,{onClick:()=>{n(),t("/notifications/unread")},children:e.jsx(Xe,{})})]}),children:e.jsxs(D,{spacing:"xs",children:[e.jsx(Y,{}),e.jsx(fe,{visible:r.isFetching}),(((u=(a=r.data)==null?void 0:a.results)==null?void 0:u.length)??0)==0&&e.jsx(Q,{color:"green",children:e.jsx(S,{size:"sm",children:h._({id:"t2pqHO"})})}),(_=(k=r.data)==null?void 0:k.results)==null?void 0:_.map(i=>{var c,x,E,I;return e.jsxs(f,{position:"apart",children:[e.jsxs(D,{spacing:"3",children:[(c=i==null?void 0:i.target)!=null&&c.link?e.jsx(S,{size:"sm",component:z,to:(x=i==null?void 0:i.target)==null?void 0:x.link,target:"_blank",children:((E=i.target)==null?void 0:E.name)??i.name??h._({id:"5+87Pq"})}):e.jsx(S,{size:"sm",children:((I=i.target)==null?void 0:I.name)??i.name??h._({id:"5+87Pq"})}),e.jsx(S,{size:"xs",children:i.age_human??""})]}),e.jsx(M,{}),e.jsx(y,{color:"gray",variant:"hover",onClick:()=>{let C=T(O.notifications_list,i.pk);H.patch(C,{read:!0}).then(p=>{r.refetch()})},children:e.jsx(ke,{label:h._({id:"+s1J8k"}),children:e.jsx(Qe,{})})})]},i.pk)})]})})}function ps({query:s,onRemove:n,onResultClick:t}){if(s.results.count==0)return null;const r=ce[s.model];return e.jsx(we,{shadow:"sm",radius:"xs",p:"md",children:e.jsxs(D,{children:[e.jsxs(f,{position:"apart",noWrap:!0,children:[e.jsxs(f,{position:"left",spacing:5,noWrap:!0,children:[e.jsx(S,{size:"lg",children:r.label_multiple}),e.jsxs(S,{size:"sm",italic:!0,children:[" ","- ",s.results.count," ",e.jsx(o,{id:"mO8KLE"})]})]}),e.jsx(M,{}),e.jsx(y,{size:"sm",color:"red",variant:"transparent",radius:"xs",onClick:()=>n(s.model),children:e.jsx(Ue,{})})]}),e.jsx(Y,{}),e.jsx(D,{children:s.results.results.map(a=>e.jsx(L,{onClick:()=>t(s.model,a.pk),children:e.jsx(Je,{instance:a,model:s.model})},a.pk))}),e.jsx(M,{})]},`stack-${s.model}`)},`paper-${s.model}`)}function js({opened:s,onClose:n}){const[t,r]=g.useState(""),[a]=ve(t,500),[u,k]=g.useState(!1),[_,i]=g.useState(!1),c=oe(),x=Ve(),I=g.useMemo(()=>[{model:v.part,parameters:{},enabled:c.hasViewRole(m.part)&&x.isSet("SEARCH_PREVIEW_SHOW_PARTS")},{model:v.supplierpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:c.hasViewRole(m.part)&&c.hasViewRole(m.purchase_order)&&x.isSet("SEARCH_PREVIEW_SHOW_SUPPLIER_PARTS")},{model:v.manufacturerpart,parameters:{part_detail:!0,supplier_detail:!0,manufacturer_detail:!0},enabled:c.hasViewRole(m.part)&&c.hasViewRole(m.purchase_order)&&x.isSet("SEARCH_PREVIEW_SHOW_MANUFACTURER_PARTS")},{model:v.partcategory,parameters:{},enabled:c.hasViewRole(m.part_category)&&x.isSet("SEARCH_PREVIEW_SHOW_CATEGORIES")},{model:v.stockitem,parameters:{part_detail:!0,location_detail:!0},enabled:c.hasViewRole(m.stock)&&x.isSet("SEARCH_PREVIEW_SHOW_STOCK")},{model:v.stocklocation,parameters:{},enabled:c.hasViewRole(m.stock_location)&&x.isSet("SEARCH_PREVIEW_SHOW_LOCATIONS")},{model:v.build,parameters:{part_detail:!0},enabled:c.hasViewRole(m.build)&&x.isSet("SEARCH_PREVIEW_SHOW_BUILD_ORDERS")},{model:v.company,parameters:{},enabled:(c.hasViewRole(m.sales_order)||c.hasViewRole(m.purchase_order))&&x.isSet("SEARCH_PREVIEW_SHOW_COMPANIES")},{model:v.purchaseorder,parameters:{supplier_detail:!0},enabled:c.hasViewRole(m.purchase_order)&&x.isSet("SEARCH_PREVIEW_SHOW_PURCHASE_ORDERS")},{model:v.salesorder,parameters:{customer_detail:!0},enabled:c.hasViewRole(m.sales_order)&&x.isSet("SEARCH_PREVIEW_SHOW_SALES_ORDERS")},{model:v.returnorder,parameters:{customer_detail:!0},enabled:c.hasViewRole(m.return_order)&&x.isSet("SEARCH_PREVIEW_SHOW_RETURN_ORDERS")}],[c,x]).filter(l=>l.enabled);g.useEffect(()=>{p.refetch()},[a]);const p=$({queryKey:["search",a,u,_],queryFn:async()=>{if(!a)return[];let l={offset:0,limit:10,search:a,search_regex:u,search_whole:_};return I.forEach(d=>{l[d.model]=d.parameters}),H.post(T(O.api_search),l).then(function(d){return d.data}).catch(function(d){return console.error(d),[]})},refetchOnWindowFocus:!1}),[P,W]=g.useState([]);g.useEffect(()=>{if(p.data){let l=I.filter(d=>d.model in p.data);for(let d in p.data){let w=l.find(F=>F.model==d);w&&(w.results=p.data[d])}l=l.filter(d=>d.results.count>0),W(l)}else W([])},[p.data]);function ue(l){W(P.filter(d=>d.model!=l))}function se(){r(""),n()}const xe=A();function pe(l,d){se();const w=ce[l];w.url_detail!=null&&xe(w.url_detail.replace(":pk",d.toString()))}return e.jsxs(X,{opened:s,size:"xl",onClose:se,position:"right",withCloseButton:!1,styles:{header:{width:"100%"},title:{width:"100%"}},title:e.jsxs(f,{position:"apart",spacing:1,noWrap:!0,children:[e.jsx(Se,{placeholder:h._({id:"Dwt0g3"}),radius:"xs",value:t,onChange:l=>r(l.currentTarget.value),icon:e.jsx(J,{size:"0.8rem"}),rightSection:t&&e.jsx(Ye,{color:"red",onClick:()=>r("")}),styles:{root:{width:"100%"}}}),e.jsx(y,{size:"lg",variant:"outline",radius:"xs",onClick:()=>p.refetch(),children:e.jsx(qe,{})}),e.jsxs(j,{children:[e.jsx(j.Target,{children:e.jsx(y,{size:"lg",variant:"outline",radius:"xs",children:e.jsx(de,{})})}),e.jsxs(j.Dropdown,{children:[e.jsx(j.Label,{children:h._({id:"9UYKcs"})}),e.jsx(j.Item,{children:e.jsx(te,{label:h._({id:"qkCZlJ"}),checked:u,onChange:l=>k(l.currentTarget.checked),radius:"sm"})}),e.jsx(j.Item,{children:e.jsx(te,{label:h._({id:"roauu/"}),checked:_,onChange:l=>i(l.currentTarget.checked),radius:"sm"})})]})]})]}),children:[p.isFetching&&e.jsx(_e,{children:e.jsx(ye,{})}),!p.isFetching&&!p.isError&&e.jsx(D,{spacing:"md",children:P.map((l,d)=>e.jsx(ps,{query:l,onRemove:w=>ue(w),onResultClick:(w,F)=>pe(w,F)},d))}),p.isError&&e.jsx(Q,{color:"red",radius:"sm",variant:"light",title:h._({id:"SlfejT"}),icon:e.jsx(Ge,{size:"1rem"}),children:e.jsx(o,{id:"hJCuaV"})}),a&&!p.isFetching&&!p.isError&&P.length==0&&e.jsx(Q,{color:"blue",radius:"sm",variant:"light",title:h._({id:"Ev2r9A"}),icon:e.jsx(J,{size:"1rem"}),children:e.jsx(o,{id:"dTtbrX"})})]})}function ms(){const{classes:s}=b(),[n,{open:t,close:r}]=B(!1),[a,{open:u,close:k}]=B(!1),[_,{open:i,close:c}]=B(!1),[x,E]=g.useState(0),I=$({queryKey:["notification-count"],queryFn:async()=>{try{const C={params:{read:!1,limit:1}};let p=await H.get(T(O.notifications_list),C);return E(p.data.count),p.data}catch(C){return C}},refetchInterval:3e4,refetchOnMount:!0,refetchOnWindowFocus:!1});return e.jsxs("div",{className:s.layoutHeader,children:[e.jsx(js,{opened:a,onClose:k}),e.jsx(hs,{opened:n,close:r}),e.jsx(xs,{opened:_,onClose:()=>{I.refetch(),c()}}),e.jsx(N,{className:s.layoutHeaderSection,size:"100%",children:e.jsxs(f,{position:"apart",children:[e.jsxs(f,{children:[e.jsx(ds,{openDrawer:t}),e.jsx(gs,{})]}),e.jsxs(f,{children:[e.jsx(y,{onClick:u,children:e.jsx(J,{})}),e.jsx(os,{}),e.jsx(y,{onClick:i,children:e.jsx(be,{radius:"lg",size:"18",label:x,color:"red",disabled:x<=0,children:e.jsx($e,{})})}),e.jsx(ls,{})]})]})})]})}function gs(){const{classes:s}=b(),n=A(),t=Ne(":tabName/*"),r=t==null?void 0:t.params.tabName;return e.jsx(Z,{defaultValue:"home",classNames:{root:s.tabs,tabsList:s.tabsList,tab:s.tab},value:r,onTabChange:a=>a=="/"?n("/"):n(`/${a}`),children:e.jsx(Z.List,{children:Oe.map(a=>e.jsx(Z.Tab,{value:a.name,children:a.text},a.name))})})}const fs=({children:s})=>{const[n]=ze(r=>[r.token]),t=Pe();return n?s:e.jsx(We,{to:"/logged-in",state:{redirectFrom:t.pathname}})};function Os(){const{classes:s}=b();return e.jsx(fs,{children:e.jsxs(ie,{direction:"column",mih:"100vh",children:[e.jsx(ms,{}),e.jsx(N,{className:s.layoutContent,size:"100%",children:e.jsx(Ae,{})}),e.jsx(M,{h:"xl"}),e.jsx(is,{})]})})}export{fs as ProtectedRoute,Os as default};
