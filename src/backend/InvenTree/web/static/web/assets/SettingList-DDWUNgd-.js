import{j as e,S as j,G as h,T as M,h as n,A as _,as as T,ae as b,r as m,K as L,D as S,aI as P,R as I,bl as y}from"./vendor-C5fHLTDD.js";import{L as R}from"./DesktopAppView-DlNUv0Ur.js";import{g as z,j as C,l as F,s as f,i as d,x as v,c as U,b as w,y as E,z as G}from"./index-DX4YmBvQ.js";import{T as t}from"./BaseContext-BGXKB9QI.js";import{R as A}from"./ApiForm-Dtyf-xF2.js";import{I as D}from"./IconEdit-DwKL16RF.js";/**
 * @license @tabler/icons-react v3.1.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var B=z("outline","switch","IconSwitch",[["path",{d:"M15 4l4 0l0 4",key:"svg-0"}],["path",{d:"M14.75 9.25l4.25 -5.25",key:"svg-1"}],["path",{d:"M5 19l4 -4",key:"svg-2"}],["path",{d:"M15 19l4 0l0 -4",key:"svg-3"}],["path",{d:"M5 5l14 14",key:"svg-4"}]]);function Q({title:c,shorthand:r,subtitle:l,switch_condition:i=!0,switch_text:a,switch_link:s}){return e.jsxs(j,{spacing:"0",ml:"sm",children:[e.jsxs(h,{children:[e.jsx(M,{order:3,children:c}),r&&e.jsxs(n,{c:"dimmed",children:["(",r,")"]})]}),e.jsxs(h,{children:[e.jsx(n,{c:"dimmed",children:l}),a&&s&&i&&e.jsxs(_,{component:R,to:s,children:[e.jsx(B,{size:14}),a]})]})]})}function H({settingsState:c,setting:r,onChange:l}){function i(o){C.patch(F(c.endpoint,r.key,c.pathParams),{value:o}).then(()=>{f({title:d._({id:"C3htzi"}),message:d._({id:"FImCSc",values:{0:r==null?void 0:r.name}}),color:"green"}),c.fetchSettings(),l==null||l()}).catch(u=>{f({title:d._({id:"CsUgn+"}),message:u.message,color:"red"})})}function a(){var u;const o={value:(r==null?void 0:r.value)??"",field_type:(r==null?void 0:r.type)??"string",label:r==null?void 0:r.name,description:r==null?void 0:r.description};o.field_type===v.Model&&r.api_url&&r.model_name?(o.api_url=r.api_url,o.model=r.model_name.split(".")[1]):((u=r.choices)==null?void 0:u.length)>0&&(o.field_type=v.Choice,o.choices=(r==null?void 0:r.choices)||[]),A({url:c.endpoint,pk:r.key,pathParams:c.pathParams,method:"PATCH",title:d._({id:"mjN1LS"}),ignorePermissionCheck:!0,fields:{value:o},onFormSuccess(){f({title:d._({id:"C3htzi"}),message:d._({id:"FImCSc",values:{0:r==null?void 0:r.name}}),color:"green"}),c.fetchSettings(),l==null||l()}})}const s=m.useMemo(()=>{var u;let o=r.value;if(r!=null&&r.choices&&((u=r==null?void 0:r.choices)==null?void 0:u.length)>0){const p=r.choices.find(k=>k.value==r.value);o=(p==null?void 0:p.display_name)||r.value}return r!=null&&r.units&&(o=`${o} ${r.units}`),o},[r]);switch((r==null?void 0:r.type)||"string"){case"boolean":return e.jsx(P,{size:"sm",radius:"lg",checked:r.value.toLowerCase()=="true",onChange:o=>i(o.currentTarget.checked),style:{paddingRight:"20px"}});default:return s?e.jsxs(h,{spacing:"xs",position:"right",children:[e.jsx(L,{}),e.jsx(S,{variant:"subtle",onClick:a,children:s})]}):e.jsx(S,{variant:"subtle",onClick:a,children:e.jsx(D,{})})}}function K({settingsState:c,setting:r,shaded:l,onChange:i}){const a=T(),s={paddingLeft:"8px"};return l&&(s.backgroundColor=a.colorScheme==="light"?a.colors.gray[1]:a.colors.gray[9]),e.jsx(b,{style:s,children:e.jsxs(h,{position:"apart",p:"3",children:[e.jsxs(j,{spacing:"2",p:"4px",children:[e.jsxs(n,{children:[r.name,r.required?" *":""]}),e.jsx(n,{size:"xs",children:r.description})]}),e.jsx(H,{settingsState:c,setting:r,onChange:i})]})})}function x({settingsState:c,keys:r,onChange:l}){m.useEffect(()=>{c.fetchSettings()},[]);const i=m.useMemo(()=>{var a;return(a=c==null?void 0:c.settings)==null?void 0:a.map(s=>s.key)},[c==null?void 0:c.settings]);return e.jsx(e.Fragment,{children:e.jsxs(j,{spacing:"xs",children:[(r||i).map((a,s)=>{var u;const o=(u=c==null?void 0:c.settings)==null?void 0:u.find(p=>p.key===a);return e.jsx(I.Fragment,{children:o?e.jsx(K,{settingsState:c,setting:o,shaded:s%2===0,onChange:l}):e.jsxs(n,{size:"sm",italic:!0,color:"red",children:["Setting ",a," not found"]})},a)}),(r||i).length===0&&e.jsx(n,{italic:!0,children:e.jsx(t,{id:"3CUVvD"})})]})})}function W({keys:c}){const r=U();return e.jsx(x,{settingsState:r,keys:c})}function X({keys:c}){const r=w();return e.jsx(x,{settingsState:r,keys:c})}function Y({pluginPk:c}){const r=m.useRef(E({plugin:c})).current,l=y(r);return e.jsx(x,{settingsState:l})}function Z({machinePk:c,configType:r,onChange:l}){const i=m.useRef(G({machine:c,configType:r})).current,a=y(i);return e.jsx(x,{settingsState:a,onChange:l})}export{X as G,Z as M,Y as P,Q as S,W as U};
