import{r as _,j as i,h as s,G as m}from"./vendor-C5fHLTDD.js";import{a as f,A as c,i as a,M as b,U as h,l as x}from"./index-DX4YmBvQ.js";import{A as g}from"./AddItemButton-BjrbTsCx.js";import{P as y,D as j,e as k,h as T,L as v}from"./ColumnRenderers-Dz-jxqgo.js";import{u as C}from"./PartForms-FGG79plz.js";import{u as M,g as P,I as S}from"./InvenTreeTable-LkhQVMZE.js";import{a as A}from"./UseForm-Btt47jru.js";import{u as w}from"./DesktopAppView-DlNUv0Ur.js";function D({str:e,len:t=100}){if(e=e??"",e=e.toString(),e.length<=t)return e;let l=Math.floor(t/2-1);return e.slice(0,l)+"..."+e.slice(-l)}function F(){return[{accessor:"name",sortable:!0,noWrap:!0,render:e=>y(e)},{accessor:"IPN",sortable:!0},{accessor:"units",sortable:!0},j({}),{accessor:"category",sortable:!0,render:function(e){var t;return D({str:(t=e.category_detail)==null?void 0:t.pathstring})}},{accessor:"total_in_stock",sortable:!0,render:e=>{let t=[],l=(e==null?void 0:e.total_in_stock)??0,p=((e==null?void 0:e.allocated_to_build_orders)??0)+((e==null?void 0:e.allocated_to_sales_orders)??0),o=Math.max(0,l-p),r=(e==null?void 0:e.minimum_stock)??0,d=String(l),n;return r>l&&(t.push(i.jsx(s,{color:"orange",children:a._({id:"Lgnuy/"})+`: ${r}`},"min-stock")),n="orange"),e.ordering>0&&t.push(i.jsx(s,{children:a._({id:"0lg3zX"})+`: ${e.ordering}`},"on-order")),e.building&&t.push(i.jsx(s,{children:a._({id:"oZd08v"})+`: ${e.building}`},"building")),e.allocated_to_build_orders>0&&t.push(i.jsx(s,{children:a._({id:"KCpl4N"})+`: ${e.allocated_to_build_orders}`},"bo-allocations")),e.allocated_to_sales_orders>0&&t.push(i.jsx(s,{children:a._({id:"DaWMWw"})+`: ${e.allocated_to_sales_orders}`},"so-allocations")),o!=l&&t.push(i.jsxs(s,{children:[a._({id:"csDS2L"}),": ",o]},"available")),e.external_stock>0&&t.push(i.jsxs(s,{children:[a._({id:"e8fwfT"}),": ",e.external_stock]},"external")),l<=0?(n="red",d=a._({id:"AbC1Px"})):o<=0?n="orange":o<r&&(n="yellow"),i.jsx(k,{value:i.jsxs(m,{spacing:"xs",position:"left",noWrap:!0,children:[i.jsx(s,{color:n,children:d}),e.units&&i.jsxs(s,{size:"xs",color:n,children:["[",e.units,"]"]})]}),title:a._({id:"odasNw"}),extra:t})}},{accessor:"price_range",title:a._({id:"YA4hwj"}),sortable:!1,render:e=>T(e.pricing_min,e.pricing_max)},v({})]}function W(){return[{name:"active",label:a._({id:"F6pfE9"}),description:a._({id:"PHri/6"}),type:"boolean"},{name:"assembly",label:a._({id:"WL36Yh"}),description:a._({id:"oQzKsK"}),type:"boolean"},{name:"cascade",label:a._({id:"NgZniC"}),description:a._({id:"5JhtGd"}),type:"boolean"},{name:"component",label:a._({id:"dK3Z9j"}),description:a._({id:"oO7QIX"}),type:"boolean"},{name:"trackable",label:a._({id:"y6MnU0"}),description:a._({id:"MbixSq"}),type:"boolean"},{name:"has_units",label:a._({id:"YyRdJQ"}),description:a._({id:"WyFVby"}),type:"boolean"},{name:"has_ipn",label:a._({id:"c9/Fqb"}),description:a._({id:"jh/Aa+"}),type:"boolean"},{name:"has_stock",label:a._({id:"JqmfuT"}),description:a._({id:"6Kd+HK"}),type:"boolean"},{name:"low_stock",label:a._({id:"UgdO7s"}),description:a._({id:"GDYPCw"}),type:"boolean"},{name:"purchaseable",label:a._({id:"TW9g28"}),description:a._({id:"KMdl2R"}),type:"boolean"},{name:"salable",label:a._({id:"/3xNJ4"}),description:a._({id:"V5i7hf"}),type:"boolean"},{name:"virtual",label:a._({id:"ksX7Wx"}),description:a._({id:"QDTpY6"}),type:"choice",choices:[{value:"true",label:a._({id:"ksX7Wx"})},{value:"false",label:a._({id:"+SkaI8"})}]}]}function $({props:e}){const t=_.useMemo(()=>F(),[]),l=_.useMemo(()=>W(),[]),p=M("part-list"),o=f(),r=w(),d=A({url:c.part_list,title:a._({id:"rGfVOS"}),fields:C({create:!0}),initialData:{...e.params??{}},onFormSuccess:u=>{u.pk&&r(P(b.part,u.pk))}}),n=_.useMemo(()=>[i.jsx(g,{hidden:!o.hasAddRole(h.part),tooltip:a._({id:"rGfVOS"}),onClick:()=>d.open()})],[o]);return i.jsxs(i.Fragment,{children:[d.modal,i.jsx(S,{url:x(c.part_list),tableState:p,columns:t,props:{...e,enableDownload:!0,modelType:b.part,tableFilters:l,tableActions:n,params:{...e.params,category_detail:!0}}})]})}export{$ as P};
