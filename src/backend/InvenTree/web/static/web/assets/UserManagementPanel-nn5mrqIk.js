import{r as a,j as e,z as w,h as f,S as b,T as _,G as T,a9 as B,bq as N,br as S,H as O,A as P}from"./vendor-C5fHLTDD.js";import{T as i}from"./BaseContext-BGXKB9QI.js";import{u as C,L as y}from"./DesktopAppView-DlNUv0Ur.js";import{G as z}from"./SettingList-DDWUNgd-.js";import{i as t,A as u,l as F,a as Q}from"./index-DX4YmBvQ.js";import{A}from"./AddItemButton-BjrbTsCx.js";import{T as G}from"./ApiForm-Dtyf-xF2.js";import{P as W}from"./Placeholder-C1-1kY0o.js";import{D as U,a as $}from"./DetailDrawer-UU2gEx54.js";import{b as E,a as L}from"./UseForm-Btt47jru.js";import{u as I}from"./UseInstance-rwUPjJ4i.js";import{u as D,R as M,a as v,I as R}from"./InvenTreeTable-LkhQVMZE.js";import{B as g}from"./ColumnRenderers-Dz-jxqgo.js";import{I as q}from"./IconInfoCircle-D5K91YCo.js";import"./IconEdit-DwKL16RF.js";import"./ActionButton-seel8ZoK.js";import"./notifications-DM-9a7Is.js";import"./IconPlus-QsNVBJ5N.js";import"./Instance-c0njg-mI.js";import"./IconTrash-KFql82qv.js";import"./IconExternalLink-CDh1KHXW.js";import"./IconQrcode-DcoHpd2K.js";import"./StylishText-CD9I8-X7.js";import"./ModelType-C8nSW6qW.js";import"./IconSearch-CKaD9XHL.js";import"./IconRefresh-ClXNAr2V.js";import"./ProgressBar-BhbAlmdB.js";import"./YesNoButton-DIAHIY63.js";function Y({id:r,refreshTable:d}){var n;const{refreshInstance:o,instanceQuery:{isFetching:m,error:l}}=I({endpoint:u.group_list,pk:r,throwError:!0});return m?e.jsx(w,{visible:!0}):l?e.jsx(f,{children:((n=l==null?void 0:l.response)==null?void 0:n.status)===404?e.jsx(i,{id:"yO7e9w",values:{id:r}}):e.jsx(i,{id:"rubZxD"})}):e.jsxs(b,{children:[e.jsx(G,{props:{url:u.group_list,pk:r,fields:{name:{}},onFormSuccess:()=>{d(),o()}},id:`group-detail-drawer-${r}`}),e.jsx(_,{order:5,children:e.jsx(i,{id:"B7dQAo"})}),e.jsx(T,{children:e.jsx(W,{})})]})}function H(){const r=D("groups"),d=C(),o=a.useCallback(s=>d(`group-${s}/`),[]),m=a.useMemo(()=>[{accessor:"name",sortable:!0,title:t._({id:"6YtxFj"})}],[]),l=a.useCallback(s=>[M({onClick:()=>o(s.pk)}),v({onClick:()=>{x(s.pk),c.open()}})],[]),[n,x]=a.useState(-1),c=E({url:u.group_list,pk:n,title:t._({id:"k/RLDM"}),successMessage:t._({id:"qYB1E/"}),onFormSuccess:r.refreshTable,preFormWarning:t._({id:"X8Qpil"})}),p=L({url:u.group_list,title:t._({id:"bm8pgG"}),fields:{name:{}},onFormSuccess:r.refreshTable}),j=a.useMemo(()=>{let s=[];return s.push(e.jsx(A,{onClick:()=>p.open(),tooltip:t._({id:"bm8pgG"})},"add-group")),s},[]);return e.jsxs(e.Fragment,{children:[p.modal,c.modal,e.jsx(U,{title:t._({id:"46SUtl"}),renderContent:s=>!s||!s.startsWith("group-")?!1:e.jsx(Y,{id:s.replace("group-",""),refreshTable:r.refreshTable})}),e.jsx(R,{url:F(u.group_list),tableState:r,columns:m,props:{rowActions:l,tableActions:j,onRowClick:s=>o(s.pk)}})]})}function X({id:r,refreshTable:d}){var p,j,s;const{instance:o,refreshInstance:m,instanceQuery:{isFetching:l,error:n}}=I({endpoint:u.user_list,pk:r,throwError:!0}),x=Q(h=>{var k;return(k=h.user)==null?void 0:k.pk}),c=a.useMemo(()=>x===parseInt(r,10),[x,r]);return l?e.jsx(w,{visible:!0}):n?e.jsx(f,{children:((p=n==null?void 0:n.response)==null?void 0:p.status)===404?e.jsx(i,{id:"z0pfhl",values:{id:r}}):e.jsx(i,{id:"h/t9U9"})}):e.jsxs(b,{children:[e.jsx(G,{props:{url:u.user_list,pk:r,fields:{username:{},first_name:{},last_name:{},email:{},is_active:{label:t._({id:"bhnh17"}),description:t._({id:"xYgjoW"}),disabled:c},is_staff:{label:t._({id:"F5kfLm"}),description:t._({id:"paSmTV"}),disabled:c},is_superuser:{label:t._({id:"tIIrDc"}),description:t._({id:"dNitd2"}),disabled:c}},postFormContent:c?e.jsx(B,{title:e.jsx(i,{id:"CE+M2e"}),color:"blue",icon:e.jsx(q,{}),children:e.jsx(i,{id:"bDFcjC"})}):void 0,onFormSuccess:()=>{d(),m()}},id:`user-detail-drawer-${r}`}),e.jsxs(b,{children:[e.jsx(_,{order:5,children:e.jsx(i,{id:"zhrjek"})}),e.jsx(N,{maxHeight:125,showLabel:"Show More",hideLabel:"Show Less",children:e.jsx(f,{ml:"md",children:o!=null&&o.groups&&((j=o==null?void 0:o.groups)==null?void 0:j.length)>0?e.jsx(S,{children:(s=o==null?void 0:o.groups)==null?void 0:s.map(h=>e.jsx(S.Item,{children:e.jsx($,{to:`../group-${h.pk}`,text:h.name})},h.pk))}):e.jsx(i,{id:"n7RDzR"})})})]})]})}function Z(){const r=D("users"),d=C(),o=a.useCallback(s=>d(`user-${s}/`),[]),m=a.useMemo(()=>[{accessor:"email",sortable:!0},{accessor:"username",sortable:!0,switchable:!1},{accessor:"first_name",sortable:!0},{accessor:"last_name",sortable:!0},{accessor:"groups",sortable:!0,switchable:!0,render:s=>s.groups.length},g({accessor:"is_staff"}),g({accessor:"is_superuser"}),g({accessor:"is_active"})],[]),[l,n]=a.useState(-1),x=a.useCallback(s=>[M({onClick:()=>o(s.pk)}),v({onClick:()=>{n(s.pk),c.open()}})],[]),c=E({url:u.user_list,pk:l,title:t._({id:"E33LRn"}),successMessage:t._({id:"Z1AUmg"}),onFormSuccess:r.refreshTable,preFormWarning:t._({id:"af4xhp"})}),p=L({url:u.user_list,title:t._({id:"UbwSmF"}),fields:{username:{},email:{},first_name:{},last_name:{}},onFormSuccess:r.refreshTable,successMessage:t._({id:"e7XEqK"})}),j=a.useMemo(()=>{let s=[];return s.push(e.jsx(A,{onClick:p.open,tooltip:t._({id:"UbwSmF"})},"add-user")),s},[]);return e.jsxs(e.Fragment,{children:[p.modal,c.modal,e.jsx(U,{title:t._({id:"poTr35"}),renderContent:s=>!s||!s.startsWith("user-")?!1:e.jsx(X,{id:s.replace("user-",""),refreshTable:r.refreshTable})}),e.jsx(R,{url:F(u.user_list),tableState:r,columns:m,props:{rowActions:x,tableActions:j,onRowClick:s=>o(s.pk)}})]})}function Ce(){return e.jsxs(b,{spacing:"xs",children:[e.jsx(_,{order:5,children:e.jsx(i,{id:"Sxm8rQ"})}),e.jsx(Z,{}),e.jsx(_,{order:5,children:e.jsx(i,{id:"zhrjek"})}),e.jsx(H,{}),e.jsx(O,{}),e.jsxs(b,{spacing:0,children:[e.jsx(f,{children:e.jsx(i,{id:"Tz0i8g"})}),e.jsxs(T,{children:[e.jsx(f,{c:"dimmed",children:e.jsx(i,{id:"L83fOm"})}),e.jsx(P,{component:y,to:"/settings/system",children:e.jsx(i,{id:"D4SseJ"})})]})]}),e.jsx(z,{keys:["LOGIN_ENABLE_REG","SIGNUP_GROUP","LOGIN_ENABLE_SSO_REG"]})]})}export{Ce as default};
