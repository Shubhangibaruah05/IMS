import{j as c,S as y,G as j,T as P,m as u,A as z,e_ as E,bI as R,c4 as U,r as n,bb as w,q as b,Z as G,cW as $,i as x,n as f,R as B,e$ as L}from"./vendor-B0vSnHFf.js";import{L as F}from"./DesktopAppView-CofLSp00.js";import{T as I}from"./BaseContext-DSwOqL9e.js";import{v as k,i as V,s as A,d as q,e as C,z as D,B as H}from"./index-CDdQlqFV.js";import{u as K}from"./UseForm-BimrM1zK.js";import{B as N}from"./Boundary-CysPC9mI.js";function ee({title:e,shorthand:s,subtitle:o,switch_condition:a=!0,switch_text:r,switch_link:i}){return c.jsxs(y,{gap:"0",ml:"sm",children:[c.jsxs(j,{children:[c.jsx(P,{order:3,children:e}),s&&c.jsxs(u,{c:"dimmed",children:["(",s,")"]})]}),c.jsxs(j,{children:[o?c.jsx(u,{c:"dimmed",children:o}):null,r&&i&&a&&c.jsxs(z,{component:F,to:i,children:[c.jsx(E,{size:14}),r]})]})]})}function W({setting:e,onEdit:s,onToggle:o}){const a=n.useMemo(()=>{var i;let r=e.value;if(e!=null&&e.choices&&((i=e==null?void 0:e.choices)==null?void 0:i.length)>0){const d=e.choices.find(p=>p.value==e.value);r=(d==null?void 0:d.display_name)||e.value}return e!=null&&e.units&&(r=`${r} ${e.units}`),r},[e]);switch((e==null?void 0:e.type)||"string"){case"boolean":return c.jsx($,{size:"sm",radius:"lg",checked:e.value.toLowerCase()=="true",onChange:r=>o(e,r.currentTarget.checked),style:{paddingRight:"20px"}});default:return a?c.jsxs(j,{gap:"xs",justify:"right",children:[c.jsx(w,{}),c.jsx(b,{variant:"subtle",onClick:()=>s(e),children:a})]}):c.jsx(b,{variant:"subtle",onClick:()=>s(e),children:c.jsx(G,{})})}}function Z({setting:e,shaded:s,onEdit:o,onToggle:a}){const{colorScheme:r}=R(),i={paddingLeft:"8px"};return s&&(i.backgroundColor=r==="light"?k.colors.gray[1]:k.colors.gray[9]),c.jsx(U,{style:i,children:c.jsxs(j,{justify:"space-between",p:"3",children:[c.jsxs(y,{gap:"2",p:"4px",children:[c.jsxs(u,{children:[e.name,e.required?" *":""]}),c.jsx(u,{size:"xs",children:e.description})]}),c.jsx(N,{label:`setting-value-${e.key}`,children:c.jsx(W,{setting:e,onEdit:o,onToggle:a})})]})})}function t({settingsState:e,keys:s,onChange:o}){var S;n.useEffect(()=>{e.fetchSettings()},[]);const a=n.useMemo(()=>{var l;return(l=e==null?void 0:e.settings)==null?void 0:l.map(m=>m.key)},[e==null?void 0:e.settings]),[r,i]=n.useState(void 0),d=n.useMemo(()=>{var l;return(l=r==null?void 0:r.choices)!=null&&l.length?"choice":(r==null?void 0:r.type)!=null?r.type:"string"},[r]),p=K({url:e.endpoint,pk:r==null?void 0:r.key,pathParams:e.pathParams,title:x._({id:"mjN1LS"}),fields:{value:{field_type:d,label:r==null?void 0:r.name,description:r==null?void 0:r.description,api_url:(r==null?void 0:r.api_url)??"",model:((S=r==null?void 0:r.model_name)==null?void 0:S.split(".")[1])??null,choices:(r==null?void 0:r.choices)??void 0}},successMessage:x._({id:"n/n6vh",values:{0:r==null?void 0:r.key}}),onFormSuccess:()=>{e.fetchSettings(),o==null||o()}}),M=n.useCallback(l=>{i(l),p.open()},[p]),T=n.useCallback((l,m)=>{q.patch(C(e.endpoint,l.key,e.pathParams),{value:m}).then(()=>{f.hide("setting"),f.show({title:x._({id:"C3htzi"}),message:x._({id:"n/n6vh",values:{0:l.key}}),color:"green",id:"setting"}),o==null||o()}).catch(h=>{f.hide("setting"),f.show({title:x._({id:"CsUgn+"}),message:h.message,color:"red",id:"setting"})}).finally(()=>{e.fetchSettings()})},[e]);return c.jsxs(c.Fragment,{children:[p.modal,c.jsxs(y,{gap:"xs",children:[(s||a).map((l,m)=>{var v;const h=(v=e==null?void 0:e.settings)==null?void 0:v.find(_=>_.key===l);return e!=null&&e.settings&&!h&&console.error(`Setting ${l} not found`),c.jsx(B.Fragment,{children:h?c.jsx(Z,{setting:h,shaded:m%2===0,onEdit:M,onToggle:T}):c.jsxs(u,{size:"sm",style:{fontStyle:"italic"},color:"red",children:["Setting ",l," not found"]})},l)}),(s||a).length===0&&c.jsx(u,{style:{fontStyle:"italic"},children:c.jsx(I,{id:"3CUVvD"})})]})]})}function re({keys:e}){const s=V();return c.jsx(t,{settingsState:s,keys:e})}function ce({keys:e}){const s=A();return c.jsx(t,{settingsState:s,keys:e})}function se({pluginKey:e}){const s=n.useRef(D({plugin:e})).current,o=L(s);return c.jsx(t,{settingsState:o})}function oe({machinePk:e,configType:s,onChange:o}){const a=n.useRef(H({machine:e,configType:s})).current,r=L(a);return c.jsx(t,{settingsState:r,onChange:o})}export{ce as G,oe as M,se as P,ee as S,re as U};
