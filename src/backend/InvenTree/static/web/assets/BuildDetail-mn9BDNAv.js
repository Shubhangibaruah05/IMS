import{r as o,i as e,j as t,m as u,G,bY as ne,P as re,K as de,b7 as Q,b9 as ce,b5 as ue,b6 as pe,ak as me,I as _e,am as be,bK as N,cY as V,z as he,eB as fe,aF as xe,b0 as je,_ as ke,eC as ge,aW as ye,ez as Ce,et as Ie,ac as Ae,ad as Be,aL as ve,S as Fe}from"./vendor-B0vSnHFf.js";import{A as Te}from"./AdminButton-Cl1ixKQi.js";import{P as te}from"./PrimaryActionButton-C__mfMnP.js";import{u as $,I as ee,B as Se,P as Oe,A as qe,E as we,d as Pe,H as De,C as Me}from"./InvenTreeTable-D26a1r6-.js";import{I as Re,D as U,a as Ne}from"./InstanceDetail-Cejekc8J.js";import{D as Ee,N as Le}from"./NotesEditor-DCyldUZp.js";import{P as ze}from"./PageDetail-B4PsctWo.js";import{P as Ge}from"./PanelGroup-DRVQKYn0.js";import{h as Ue,S as We}from"./Instance-Co8OMzcE.js";import{a as K,A as g,M as k,U as M,w as W,e as I,d as Z}from"./index-CDdQlqFV.js";import{u as ae,a as Ye,b as Ke,c as He,d as Ve,B as Xe}from"./BuildOrderTable-bQe5ddnA.js";import{a as D,u as Qe}from"./UseForm-BimrM1zK.js";import{u as Ze}from"./UseInstance-Bcp_oSAZ.js";import{u as Je}from"./UseStatusCodes-FmkSIrlp.js";import{B as $e}from"./BuildAllocatedStockTable-BtxDATbE.js";import{g as Y,a as ie,B as z,P as J,m as et,i as le}from"./ColumnRenderers-CwItNORh.js";import{P as tt}from"./YesNoButton-1B57tnbm.js";import{j as st}from"./StockForms-DLBgZVBa.js";import{A as X}from"./ActionButton-Br0cBRLA.js";import{A as at}from"./AddItemButton-CD0U_4gd.js";import{I as P}from"./BaseContext-DSwOqL9e.js";import{A as it}from"./AttachmentTable-Mxcn-H07.js";import{S as se}from"./StockItemTable-Cop_NVCl.js";import{T as lt}from"./TestStatisticsTable-B2RJEI09.js";import{d as ot}from"./DesktopAppView-CofLSp00.js";import"./Boundary-CysPC9mI.js";import"./StylishText-CrpvZzAV.js";import"./GenericErrorPage-BifXQa91.js";import"./NotFound-DXIcBWRy.js";import"./PermissionDenied-Cl_T9Vqt.js";import"./UseGenerator-C7bjPlPb.js";import"./UseFilter-Blar5lCV.js";import"./AttachmentLink-CL1ofkZf.js";function nt({buildId:l,outputId:b,params:s={}}){const h=$("buildline"),n=K(),f=o.useMemo(()=>[{name:"allocated",label:e._({id:"A/ybx7"}),description:e._({id:"qhfAiQ"})},{name:"available",label:e._({id:"csDS2L"}),description:e._({id:"INp5cq"})},{name:"consumable",label:e._({id:"duCsZf"}),description:e._({id:"4xoOP+"})},{name:"optional",label:e._({id:"LLAa/9"}),description:e._({id:"JZ0XU+"})},{name:"assembly",label:e._({id:"WL36Yh"}),description:e._({id:"yTd5+B"})},{name:"testable",label:e._({id:"bJsTOf"}),description:e._({id:"LCdyP7"})},{name:"tracked",label:e._({id:"EaG6cP"}),description:e._({id:"lY29Qz"})}],[]),T=o.useCallback(a=>{let d=(a==null?void 0:a.bom_item_detail)??{},c=[],r=a==null?void 0:a.available_stock;a.available_substitute_stock>0&&(r+=a.available_substitute_stock,c.push(t.jsx(u,{size:"sm",children:e._({id:"XTe+lK"})},"substitite"))),d.allow_variants&&a.available_variant_stock>0&&(r+=a.available_variant_stock,c.push(t.jsx(u,{size:"sm",children:e._({id:"LdvJ9e"})},"variant"))),a.in_production>0&&c.push(t.jsxs(u,{size:"sm",children:[e._({id:"G1xXyB"}),": ",a.in_production]},"production")),a.on_order>0&&c.push(t.jsxs(u,{size:"sm",children:[e._({id:"/MB+gl"}),": ",a.on_order]},"on-order")),a.external_stock>0&&c.push(t.jsxs(u,{size:"sm",children:[e._({id:"e8fwfT"}),": ",a.external_stock]},"external"));const j=r>=a.quantity-a.allocated;return j||c.push(t.jsx(u,{c:"orange",size:"sm",children:e._({id:"R7+e2m"})},"insufficient")),t.jsx(Y,{icon:j?"info":"exclamation",iconColor:j?"blue":"orange",value:r>0?r:t.jsx(u,{c:"red",style:{fontStyle:"italic"},children:e._({id:"a5n/wL"})}),title:e._({id:"oGd3rK"}),extra:c})},[]),p=o.useMemo(()=>[{accessor:"bom_item",ordering:"part",sortable:!0,switchable:!1,render:a=>ie(a.part_detail)},{accessor:"part_detail.IPN",sortable:!1,title:e._({id:"3wXEsN"})},{accessor:"part_detail.description",sortable:!1,title:e._({id:"Nu4oKW"})},{accessor:"bom_item_detail.reference",ordering:"reference",sortable:!0,title:e._({id:"N2C89m"})},z({accessor:"bom_item_detail.optional",ordering:"optional"}),z({accessor:"bom_item_detail.consumable",ordering:"consumable"}),z({accessor:"bom_item_detail.allow_variants",ordering:"allow_variants"}),z({accessor:"bom_item_detail.inherited",ordering:"inherited",title:e._({id:"UF/nv9"})}),z({accessor:"part_detail.trackable",ordering:"trackable"}),{accessor:"bom_item_detail.quantity",sortable:!0,title:e._({id:"O7oMsT"}),ordering:"unit_quantity",render:a=>{var d,c;return t.jsxs(G,{justify:"space-between",children:[t.jsx(u,{children:(d=a.bom_item_detail)==null?void 0:d.quantity}),((c=a==null?void 0:a.part_detail)==null?void 0:c.units)&&t.jsxs(u,{size:"xs",children:["[",a.part_detail.units,"]"]})]})}},{accessor:"quantity",sortable:!0,render:a=>{var d;return t.jsxs(G,{justify:"space-between",children:[t.jsx(u,{children:a.quantity}),((d=a==null?void 0:a.part_detail)==null?void 0:d.units)&&t.jsxs(u,{size:"xs",children:["[",a.part_detail.units,"]"]})]})}},{accessor:"available_stock",sortable:!0,switchable:!1,render:T},{accessor:"allocated",switchable:!1,render:a=>{var d;return(d=a==null?void 0:a.bom_item_detail)!=null&&d.consumable?t.jsx(u,{style:{fontStyle:"italic"},children:e._({id:"f/GbFw"})}):t.jsx(J,{progressLabel:!0,value:a.allocated,maximum:a.quantity})}}],[]),A=ae({create:!0}),[S,O]=o.useState({}),x=D({url:g.build_order_list,title:e._({id:"UcPKar"}),fields:A,initialData:S,follow:!0,modelType:k.build}),B=o.useCallback(a=>{var m;let d=a.part_detail??{};if((m=a==null?void 0:a.bom_item_detail)!=null&&m.consumable)return[];const c=!!b;let r=n.hasChangeRole(M.build)&&a.allocated<a.quantity&&a.trackable==c,j=n.hasAddRole(M.purchase_order)&&d.purchaseable,v=n.hasAddRole(M.build)&&d.assembly;return[{icon:t.jsx(ne,{}),title:e._({id:"L1LMmH"}),hidden:!r,color:"green",onClick:W},{icon:t.jsx(re,{}),title:e._({id:"cUzrZK"}),hidden:!j,color:"blue",onClick:W},{icon:t.jsx(de,{}),title:e._({id:"vgTd7I"}),hidden:!v,color:"blue",onClick:()=>{O({part:a.part,parent:l,quantity:a.quantity-a.allocated}),x.open()}}]},[n,b]);return t.jsxs(t.Fragment,{children:[x.modal,t.jsx(ee,{url:I(g.build_line_list),tableState:h,columns:p,props:{params:{...s,build:l,part_detail:!0},tableFilters:f,rowActions:B,modelType:k.part,modelField:"part_detail.pk",enableDownload:!0}})]})}function rt({buildId:l,partId:b}){const s=$("build-tests"),h=K(),{data:n}=Q({queryKey:["build-test-templates",b,l],queryFn:async()=>b?Z.get(I(g.part_test_template_list),{params:{part:b,include_inherited:!0,enabled:!0,required:!0}}).then(r=>r.data).catch(r=>[]):[]});o.useEffect(()=>{s.refreshTable()},[n]);const[f,T]=o.useState(0),[p,A]=o.useState(0),S=st({partId:b,itemId:f,templateId:p}),O=D({url:I(g.stock_test_result_list),title:e._({id:"VzkBcq"}),fields:S,initialData:{template:p,result:!0},onFormSuccess:()=>s.refreshTable(),successMessage:e._({id:"VivtT0"})}),x=o.useMemo(()=>!n||n.length==0?[]:n.map(r=>({accessor:`test_${r.pk}`,title:r.test_name,sortable:!1,switchable:!0,render:j=>{let m=(j.tests||[]).filter(i=>i.template==r.pk).sort((i,y)=>y.pk-i.pk).shift();if(!m||m.result===void 0)return t.jsxs(G,{gap:"xs",wrap:"nowrap",justify:"space-between",children:[t.jsx(ce,{color:"lightblue",variant:"filled",children:e._({id:"4bobEy"})}),t.jsx(ue,{label:e._({id:"VzkBcq"}),children:t.jsx(pe,{size:"xs",color:"green",variant:"transparent",onClick:()=>{T(j.pk),A(r.pk),O.open()},children:t.jsx(me,{})})})]});let _=[];return m.value&&_.push(t.jsxs(u,{size:"sm",children:[e._({id:"wMHvYH"}),": ",m.value]},"value")),m.notes&&_.push(t.jsxs(u,{size:"sm",children:[e._({id:"1DBGsz"}),": ",m.notes]},"notes")),m.date&&_.push(t.jsxs(u,{size:"sm",children:[e._({id:"mYGY3B"}),": ",et(m.date)]},"date")),m.user_detail&&_.push(t.jsx(Ue,{instance:m.user_detail},"user")),t.jsx(Y,{value:t.jsx(tt,{value:m.result}),title:r.test_name,extra:_})}})),[n]),B=o.useMemo(()=>[...[{accessor:"stock",title:e._({id:"gILim+"}),sortable:!0,switchable:!1,render:j=>{if(j.serial)return`# ${j.serial}`;{let v=[];return j.batch&&v.push(t.jsxs(u,{size:"sm",children:[e._({id:"Vea6Aj"}),": ",j.batch]},"batch")),t.jsx(Y,{value:t.jsxs(u,{children:[e._({id:"VbWX2u"}),": ",j.quantity]}),title:e._({id:"gILim+"}),extra:v})}}},le({accessor:"location_detail"})],...x],[x]),a=o.useMemo(()=>[{name:"is_building",label:e._({id:"BE5Q6v"}),description:e._({id:"AO8gAN"})}],[]),d=o.useMemo(()=>[],[]),c=o.useCallback(r=>[],[h]);return t.jsxs(t.Fragment,{children:[O.modal,t.jsx(ee,{url:I(g.stock_item_list),tableState:s,columns:B,props:{params:{part_detail:!0,location_detail:!0,tests:!0,build:l},rowActions:c,tableFilters:a,tableActions:d}})]})}function dt({build:l}){var _;const b=K(),s=$("build-outputs"),h=o.useMemo(()=>l.pk??-1,[l.pk]),n=o.useMemo(()=>l.part??-1,[l.part]),{data:f}=Q({queryKey:["buildoutputtests",n,l],queryFn:async()=>{var i;return!n||n<0?[]:(i=l==null?void 0:l.part_detail)!=null&&i.testable?Z.get(I(g.part_test_template_list),{params:{part:n,include_inherited:!0,enabled:!0,required:!0}}).then(y=>y.data).catch(()=>[]):[]}}),T=o.useMemo(()=>((f==null?void 0:f.length)??0)>0,[n,f]),{data:p}=Q({queryKey:["trackeditems",h],queryFn:async()=>!h||h<0?[]:Z.get(I(g.build_line_list),{params:{build:h,tracked:!0}}).then(i=>i.data).catch(()=>[])}),A=o.useMemo(()=>((p==null?void 0:p.length)??0)>0,[p]);o.useEffect(()=>{s.refreshTable()},[A,T]);const S=o.useCallback(i=>(i==null||i.forEach((y,F)=>{let C=[],E=0;f==null||f.forEach(w=>{var H;let q=(H=y.tests)==null?void 0:H.filter(R=>R.template==w.pk).sort((R,oe)=>R.pk<oe.pk?1:-1).shift();w!=null&&w.required&&(q!=null&&q.result)&&(E+=1),C.push({name:w.test_name,result:(q==null?void 0:q.result)??!1})}),i[F].passCount=E,i[F].results=C;let L=0;p==null||p.forEach(w=>{let q=0;w.allocations.filter(R=>R.install_into=y.pk).forEach(R=>{q+=R.quantity}),q>=w.bom_item_detail.quantity&&(L+=1)}),i[F].fullyAllocated=L}),i),[n,h,f,p]),O=Ye({build:l}),x=D({url:I(g.build_output_create,h),title:e._({id:"jgrPxc"}),fields:O,initialData:{batch_code:l.batch,location:l.destination??((_=l.part_detail)==null?void 0:_.default_location)},table:s}),[B,a]=o.useState([]),d=Ke({build:l,outputs:B,onFormSuccess:()=>{s.refreshTable()}}),c=He({build:l,outputs:B,onFormSuccess:()=>{s.refreshTable()}}),r=Ve({build:l,outputs:B,onFormSuccess:()=>{s.refreshTable()}}),j=o.useMemo(()=>[t.jsx(at,{tooltip:e._({id:"jgrPxc"}),hidden:!b.hasAddRole(M.build),onClick:x.open}),t.jsx(X,{tooltip:e._({id:"jNuqfk"}),icon:t.jsx(P,{icon:"success"}),color:"green",disabled:!s.hasSelectedRecords,onClick:()=>{a(s.selectedRecords),d.open()}}),t.jsx(X,{tooltip:e._({id:"ps+JBt"}),icon:t.jsx(P,{icon:"delete"}),color:"red",disabled:!s.hasSelectedRecords,onClick:()=>{a(s.selectedRecords),c.open()}}),t.jsx(X,{tooltip:e._({id:"MXiIO4"}),icon:t.jsx(P,{icon:"cancel"}),color:"red",disabled:!s.hasSelectedRecords,onClick:()=>{a(s.selectedRecords),r.open()}})],[b,s.selectedRecords,s.hasSelectedRecords]),v=o.useCallback(i=>[{title:e._({id:"9X8lAk"}),tooltip:e._({id:"kHgU4C"}),color:"blue",icon:t.jsx(P,{icon:"plus"}),onClick:W},{title:e._({id:"kp5oT9"}),tooltip:e._({id:"NLp8ve"}),color:"red",icon:t.jsx(P,{icon:"minus"}),onClick:W},{title:e._({id:"bD8I7O"}),tooltip:e._({id:"BdMeIY"}),color:"green",icon:t.jsx(P,{icon:"success"}),onClick:()=>{a([i]),d.open()}},{title:e._({id:"5mspUE"}),tooltip:e._({id:"oise/z"}),icon:t.jsx(P,{icon:"delete"}),color:"red",onClick:()=>{a([i]),c.open()}},{title:e._({id:"dEgA5A"}),tooltip:e._({id:"ewDpt2"}),icon:t.jsx(P,{icon:"cancel"}),color:"red",onClick:()=>{a([i]),r.open()}}],[b,n]),m=o.useMemo(()=>[{accessor:"part",sortable:!0,render:i=>ie(i==null?void 0:i.part_detail)},{accessor:"quantity",ordering:"stock",sortable:!0,switchable:!1,title:e._({id:"gILim+"}),render:i=>{let y=i.quantity;return i.serial&&(y=`# ${i.serial}`),t.jsxs(G,{justify:"left",wrap:"nowrap",children:[t.jsx(u,{children:y}),i.batch&&t.jsxs(u,{style:{fontStyle:"italic"},size:"sm",children:[e._({id:"rsx3xA"}),": ",i.batch]})]})}},le({accessor:"location_detail"}),{accessor:"allocations",sortable:!1,switchable:!1,hidden:!A,title:e._({id:"/b62hy"}),render:i=>t.jsx(J,{progressLabel:!0,value:i.fullyAllocated??0,maximum:(p==null?void 0:p.length)??0})},{accessor:"tests",sortable:!1,switchable:!1,title:e._({id:"E4lFEY"}),hidden:!T,render:i=>{var F;const y=((F=i.results)==null?void 0:F.map(C=>C&&t.jsxs(G,{justify:"left",wrap:"nowrap",children:[C.result?t.jsx(_e,{color:"green"}):t.jsx(be,{color:"red"}),t.jsx(u,{children:C.name})]},C.name)))??[];return t.jsx(Y,{value:t.jsx(J,{progressLabel:!0,value:i.passCount??0,maximum:(f==null?void 0:f.length)??0}),extra:y,title:e._({id:"isbwWo"})})}}],[h,n,T,A,f,p]);return t.jsxs(t.Fragment,{children:[x.modal,d.modal,c.modal,r.modal,t.jsx(ee,{tableState:s,url:I(g.stock_item_list),columns:m,props:{params:{part_detail:!0,tests:!0,is_building:!0,build:h},modelType:k.stockitem,dataFormatter:S,tableActions:j,rowActions:v,enableSelection:!0}})]})}function Ut(){var v,m;const{id:l}=ot(),b=K(),{instance:s,refreshInstance:h,instanceQuery:n,requestStatus:f}=Ze({endpoint:g.build_order_list,pk:l,params:{part_detail:!0},refetchOnMount:!0}),T=o.useMemo(()=>{var C,E,L;if(n.isFetching)return t.jsx(N,{});let _=[{type:"link",name:"part",label:e._({id:"vgP+9p"}),model:k.part},{type:"text",name:"part_detail.IPN",icon:"part",label:e._({id:"3wXEsN"}),hidden:!((C=s.part_detail)!=null&&C.IPN),copy:!0},{type:"status",name:"status",label:e._({id:"uAQUqI"}),model:k.build},{type:"text",name:"reference",label:e._({id:"N2C89m"}),copy:!0},{type:"text",name:"title",label:e._({id:"Nu4oKW"}),icon:"description",copy:!0},{type:"link",name:"parent",icon:"builds",label:e._({id:"jqsG41"}),model_field:"reference",model:k.build,hidden:!s.parent}],i=[{type:"text",name:"quantity",label:e._({id:"Ee+3kG"})},{type:"progressbar",name:"completed",icon:"progress",total:s.quantity,progress:s.completed,label:e._({id:"Mzv4va"})},{type:"link",name:"sales_order",label:e._({id:"LozYBo"}),icon:"sales_orders",model:k.salesorder,model_field:"reference",hidden:!s.sales_order}],y=[{type:"text",name:"issued_by",label:e._({id:"kmUN8p"}),icon:"user",badge:"user"},{type:"text",name:"responsible",label:e._({id:"XQACoK"}),badge:"owner",hidden:!s.responsible},{type:"text",name:"creation_date",label:e._({id:"d+F6q9"}),icon:"calendar",hidden:!s.creation_date},{type:"text",name:"target_date",label:e._({id:"ZmykKo"}),icon:"calendar",hidden:!s.target_date},{type:"text",name:"completion_date",label:e._({id:"qqWcBV"}),icon:"calendar",hidden:!s.completion_date}],F=[{type:"link",name:"take_from",icon:"location",model:k.stocklocation,label:e._({id:"/00Ond"}),backup_value:e._({id:"aZD9Yv"})},{type:"link",name:"destination",icon:"location",model:k.stocklocation,label:e._({id:"o35LCI"}),hidden:!s.destination},{type:"text",name:"batch",label:e._({id:"Vea6Aj"}),hidden:!s.batch,copy:!0}];return t.jsxs(Re,{children:[t.jsxs(V,{children:[t.jsx(V.Col,{span:4,children:t.jsx(Ee,{appRole:M.part,apiPath:g.part_list,src:((E=s.part_detail)==null?void 0:E.image)??((L=s.part_detail)==null?void 0:L.thumbnail),pk:s.part})}),t.jsx(V.Col,{span:8,children:t.jsx(U,{fields:_,item:s})})]}),t.jsx(U,{fields:i,item:s}),t.jsx(U,{fields:y,item:s}),t.jsx(U,{fields:F,item:s})]})},[s,n]),p=o.useMemo(()=>{var _,i;return[{name:"details",label:e._({id:"98Q4bz"}),icon:t.jsx(he,{}),content:T},{name:"line-items",label:e._({id:"SgduFH"}),icon:t.jsx(fe,{}),content:s!=null&&s.pk?t.jsx(nt,{buildId:s.pk}):t.jsx(N,{})},{name:"incomplete-outputs",label:e._({id:"E9en8O"}),icon:t.jsx(xe,{}),content:s.pk?t.jsx(dt,{build:s}):t.jsx(N,{})},{name:"complete-outputs",label:e._({id:"Mzv4va"}),icon:t.jsx(je,{}),content:t.jsx(se,{allowAdd:!1,tableName:"build-outputs",params:{build:l,is_building:!1}})},{name:"allocated-stock",label:e._({id:"MD2yP5"}),icon:t.jsx(ke,{}),content:s.pk?t.jsx($e,{buildId:s.pk,showPartInfo:!0,allowEdit:!0}):t.jsx(N,{})},{name:"consumed-stock",label:e._({id:"US3GCq"}),icon:t.jsx(ge,{}),content:t.jsx(se,{allowAdd:!1,tableName:"build-consumed",params:{consumed_by:l}})},{name:"child-orders",label:e._({id:"CVlgqS"}),icon:t.jsx(ye,{}),content:s.pk?t.jsx(Xe,{parentBuildId:s.pk,salesOrderId:s.sales_order}):t.jsx(N,{})},{name:"test-results",label:e._({id:"isbwWo"}),icon:t.jsx(Ce,{}),hidden:!((_=s.part_detail)!=null&&_.testable),content:s.pk?t.jsx(rt,{buildId:s.pk,partId:s.part}):t.jsx(N,{})},{name:"test-statistics",label:e._({id:"YlY+VD"}),icon:t.jsx(Ie,{}),content:t.jsx(lt,{params:{pk:s.pk,apiEndpoint:g.build_test_statistics}}),hidden:!((i=s==null?void 0:s.part_detail)!=null&&i.testable)},{name:"attachments",label:e._({id:"w/Sphq"}),icon:t.jsx(Ae,{}),content:t.jsx(it,{model_type:k.build,model_id:Number(l)})},{name:"notes",label:e._({id:"1DBGsz"}),icon:t.jsx(Be,{}),content:t.jsx(Le,{modelType:k.build,modelId:s.pk,editable:b.hasChangeRole(M.build)})}]},[s,l,b]),A=ae({create:!1}),S=Qe({url:g.build_order_list,pk:s.pk,title:e._({id:"B7ynKf"}),fields:A,onFormSuccess:h}),O=D({url:g.build_order_list,title:e._({id:"59jtLx"}),fields:A,initialData:{...s,reference:void 0},follow:!0,modelType:k.build}),x=Je({modelType:k.build}),B=D({url:I(g.build_order_cancel,s.pk),title:e._({id:"MTYJu1"}),onFormSuccess:h,successMessage:e._({id:"H5qWhm"}),preFormWarning:e._({id:"MPFqR0"}),fields:{remove_allocated_stock:{},remove_incomplete_outputs:{}}}),a=D({url:I(g.build_order_hold,s.pk),title:e._({id:"hZIvSn"}),onFormSuccess:h,preFormWarning:e._({id:"3Wfk51"}),successMessage:e._({id:"0NH/ob"})}),d=D({url:I(g.build_order_issue,s.pk),title:e._({id:"Z4Rl+B"}),onFormSuccess:h,preFormWarning:e._({id:"lLiNZC"}),successMessage:e._({id:"R/WvFK"})}),c=D({url:I(g.build_order_complete,s.pk),title:e._({id:"Q/TP3B"}),onFormSuccess:h,preFormWarning:e._({id:"DYITap"}),successMessage:e._({id:"W7TghJ"}),fields:{accept_overallocated:{},accept_unallocated:{},accept_incomplete:{}}}),r=o.useMemo(()=>{const _=b.hasChangeRole(M.build),i=_&&(s.status==x.PENDING||s.status==x.ON_HOLD),y=_&&s.status==x.PRODUCTION,F=_&&(s.status==x.PENDING||s.status==x.PRODUCTION),C=_&&(s.status==x.PENDING||s.status==x.ON_HOLD||s.status==x.PRODUCTION);return[t.jsx(te,{title:e._({id:"WajCDs"}),icon:"issue",hidden:!i,color:"blue",onClick:d.open}),t.jsx(te,{title:e._({id:"NPZqBL"}),icon:"complete",hidden:!y,color:"green",onClick:c.open}),t.jsx(Te,{model:k.build,pk:s.pk}),t.jsx(Se,{model:k.build,pk:s.pk,hash:s==null?void 0:s.barcode_hash}),t.jsx(Oe,{modelType:k.build,items:[s.pk],enableReports:!0}),t.jsx(qe,{tooltip:e._({id:"tDgG1Y"}),icon:t.jsx(ve,{}),actions:[we({onClick:()=>S.open(),hidden:!_,tooltip:e._({id:"mVeaUg"})}),Pe({onClick:()=>O.open(),tooltip:e._({id:"oi/3Pq"}),hidden:!b.hasAddRole(M.build)}),De({tooltip:e._({id:"20mLBC"}),hidden:!F,onClick:a.open}),Me({tooltip:e._({id:"tVJk4q"}),onClick:B.open,hidden:!C})]})]},[l,s,b,x]),j=o.useMemo(()=>n.isFetching?[]:[t.jsx(We,{status:s.status_custom_key,type:k.build,options:{size:"lg"}})],[s,n]);return t.jsxs(t.Fragment,{children:[S.modal,O.modal,B.modal,a.modal,d.modal,c.modal,t.jsx(Ne,{status:f,loading:n.isFetching,children:t.jsxs(Fe,{gap:"xs",children:[t.jsx(ze,{title:s.reference,subtitle:s.title,badges:j,editAction:S.open,editEnabled:b.hasChangePermission(k.part),imageUrl:((v=s.part_detail)==null?void 0:v.image)??((m=s.part_detail)==null?void 0:m.thumbnail),breadcrumbs:[{name:e._({id:"RCVhIP"}),url:"/build"},{name:s.reference,url:`/build/${s.pk}`}],actions:r}),t.jsx(Ge,{pageKey:"build",panels:p})]})})]})}export{Ut as default};
