import{r as l,i as t,j as s,bK as R,cY as C,z as v,a4 as B,cZ as G,P as L,H as O,a7 as U,a8 as W,c_ as Y,aH as H,c$ as K,ac as Q,ad as z,aL as V,S as q}from"./vendor-B0vSnHFf.js";import{A as Z}from"./AdminButton-Cl1ixKQi.js";import{I as J,D,a as X}from"./InstanceDetail-Cejekc8J.js";import{D as $}from"./DetailsBadge-oD3BwL5r.js";import{D as ee,N as se}from"./NotesEditor-DCyldUZp.js";import{u as F,R as S,a as T,I as P,A as te,E as ae,D as oe}from"./InvenTreeTable-D26a1r6-.js";import{P as re}from"./PageDetail-B4PsctWo.js";import{P as le}from"./PanelGroup-DRVQKYn0.js";import{a as A,A as i,U as r,e as y,M as j}from"./index-CDdQlqFV.js";import{c as ie}from"./CompanyForms-Dy3Tzhcs.js";import{a as E,u as w,b as I}from"./UseForm-BimrM1zK.js";import{u as ne}from"./UseInstance-Bcp_oSAZ.js";import{A as N}from"./AddItemButton-CD0U_4gd.js";import{Y as ce}from"./YesNoButton-1B57tnbm.js";import{A as de}from"./AttachmentTable-Mxcn-H07.js";import{M as pe}from"./ManufacturerPartTable-C8X4nb6m.js";import{P as me}from"./PurchaseOrderTable-Dc7Vs_m9.js";import{S as ue}from"./SupplierPartTable-B-0txwOI.js";import{R as he}from"./ReturnOrderTable-CP-r3tMw.js";import{S as _e}from"./SalesOrderTable-DKHdcoS0.js";import{S as M}from"./StockItemTable-Cop_NVCl.js";import{d as be}from"./DesktopAppView-CofLSp00.js";import"./Instance-Co8OMzcE.js";import"./ActionButton-Br0cBRLA.js";import"./BaseContext-DSwOqL9e.js";import"./ColumnRenderers-CwItNORh.js";import"./StylishText-CrpvZzAV.js";import"./GenericErrorPage-BifXQa91.js";import"./NotFound-DXIcBWRy.js";import"./PermissionDenied-Cl_T9Vqt.js";import"./Boundary-CysPC9mI.js";import"./AttachmentLink-CL1ofkZf.js";import"./PurchaseOrderForms-VnPQAsDv.js";import"./UseGenerator-C7bjPlPb.js";import"./UseFilter-Blar5lCV.js";import"./SalesOrderForms-BD5fZ2Wy.js";import"./StockForms-DLBgZVBa.js";function fe({companyId:m,params:u}){const a=A(),e=F("address"),h=l.useMemo(()=>[{accessor:"title",sortable:!0,switchable:!1},{accessor:"primary",switchable:!1,sortable:!1,render:o=>ce({value:o.primary})},{accessor:"address",title:t._({id:"Du6bPw"}),sortable:!1,switchable:!1,render:o=>{let d="";return o!=null&&o.line1&&(d+=o.line1),o!=null&&o.line2&&(d+=" "+o.line2),d.trim()}},{accessor:"postal_code",sortable:!1,switchable:!0},{accessor:"postal_city",sortable:!1,switchable:!0},{accessor:"province",sortable:!1,switchable:!0},{accessor:"country",sortable:!1,switchable:!0},{accessor:"shipping_notes",sortable:!1,switchable:!0},{accessor:"internal_shipping_notes",sortable:!1,switchable:!0},{accessor:"link",sortable:!1,switchable:!0}],[]),n=l.useMemo(()=>({company:{},title:{},primary:{},line1:{},line2:{},postal_code:{},postal_city:{},province:{},country:{},shipping_notes:{},internal_shipping_notes:{},link:{}}),[]),_=E({url:i.address_list,title:t._({id:"W0pjLr"}),fields:n,initialData:{company:m},successMessage:t._({id:"N0ZOat"}),table:e}),[b,f]=l.useState(-1),c=w({url:i.address_list,pk:b,title:t._({id:"xLQ0lF"}),fields:n,table:e}),p=I({url:i.address_list,pk:b,title:t._({id:"xiRN5x"}),preFormWarning:t._({id:"F1bgq9"}),table:e}),k=l.useCallback(o=>{let d=a.hasChangeRole(r.purchase_order)||a.hasChangeRole(r.sales_order),g=a.hasDeleteRole(r.purchase_order)||a.hasDeleteRole(r.sales_order);return[S({hidden:!d,onClick:()=>{f(o.pk),c.open()}}),T({hidden:!g,onClick:()=>{f(o.pk),p.open()}})]},[a]),x=l.useMemo(()=>{let o=a.hasChangeRole(r.purchase_order)||a.hasChangeRole(r.sales_order);return[s.jsx(N,{tooltip:t._({id:"W0pjLr"}),onClick:()=>_.open(),hidden:!o})]},[a]);return s.jsxs(s.Fragment,{children:[_.modal,c.modal,p.modal,s.jsx(P,{url:y(i.address_list),tableState:e,columns:h,props:{enableDownload:!0,rowActions:k,tableActions:x,params:{...u,company:m}}})]})}function ke({companyId:m,params:u}){const a=A(),e=F("contact"),h=l.useMemo(()=>[{accessor:"name",sortable:!0,switchable:!1},{accessor:"phone",switchable:!0,sortable:!1},{accessor:"email",switchable:!0,sortable:!1},{accessor:"role",switchable:!0,sortable:!1}],[]),n=l.useMemo(()=>({company:{},name:{},phone:{},email:{},role:{}}),[]),[_,b]=l.useState(0),f=w({url:i.contact_list,pk:_,title:t._({id:"mQpWAe"}),fields:n,onFormSuccess:o=>e.updateRecord(o)}),c=E({url:i.contact_list,title:t._({id:"M0FgOk"}),initialData:{company:m},fields:n,table:e}),p=I({url:i.contact_list,pk:_,title:t._({id:"0oMKRL"}),table:e}),k=l.useCallback(o=>{let d=a.hasChangeRole(r.purchase_order)||a.hasChangeRole(r.sales_order),g=a.hasDeleteRole(r.purchase_order)||a.hasDeleteRole(r.sales_order);return[S({hidden:!d,onClick:()=>{b(o.pk),f.open()}}),T({hidden:!g,onClick:()=>{b(o.pk),p.open()}})]},[a]),x=l.useMemo(()=>{let o=a.hasAddRole(r.purchase_order)||a.hasAddRole(r.sales_order);return[s.jsx(N,{tooltip:t._({id:"QsNWTM"}),onClick:()=>c.open(),hidden:!o})]},[a]);return s.jsxs(s.Fragment,{children:[c.modal,f.modal,p.modal,s.jsx(P,{url:y(i.contact_list),tableState:e,columns:h,props:{enableDownload:!0,rowActions:k,tableActions:x,params:{...u,company:m}}})]})}function ts(m){const{id:u}=be(),a=A(),{instance:e,refreshInstance:h,instanceQuery:n,requestStatus:_}=ne({endpoint:i.company_list,pk:u,params:{},refetchOnMount:!0}),b=l.useMemo(()=>{if(n.isFetching)return s.jsx(R,{});let o=[{type:"text",name:"description",label:t._({id:"Nu4oKW"}),copy:!0},{type:"link",name:"website",label:t._({id:"On0aF2"}),external:!0,copy:!0,hidden:!e.website},{type:"text",name:"phone",label:t._({id:"HF6C2L"}),copy:!0,hidden:!e.phone},{type:"text",name:"email",label:t._({id:"hzKQCy"}),copy:!0,hidden:!e.email}],d=[{type:"string",name:"currency",label:t._({id:"xjO9oI"})},{type:"boolean",name:"is_supplier",label:t._({id:"PYTEl0"}),icon:"suppliers"},{type:"boolean",name:"is_manufacturer",label:t._({id:"+m9/3S"}),icon:"manufacturers"},{type:"boolean",name:"is_customer",label:t._({id:"876pfE"}),icon:"customers"}];return s.jsxs(J,{children:[s.jsxs(C,{children:[s.jsx(C.Col,{span:4,children:s.jsx(ee,{appRole:r.purchase_order,apiPath:i.company_list,src:e.image,pk:e.pk,refresh:h,imageActions:{uploadFile:!0,deleteFile:!0}})}),s.jsx(C.Col,{span:8,children:s.jsx(D,{item:e,fields:o})})]}),s.jsx(D,{item:e,fields:d})]})},[e,n]),f=l.useMemo(()=>[{name:"details",label:t._({id:"URmyfc"}),icon:s.jsx(v,{}),content:b},{name:"manufactured-parts",label:t._({id:"glJbgw"}),icon:s.jsx(B,{}),hidden:!(e!=null&&e.is_manufacturer),content:(e==null?void 0:e.pk)&&s.jsx(pe,{params:{manufacturer:e.pk}})},{name:"supplied-parts",label:t._({id:"i4b9ex"}),icon:s.jsx(G,{}),hidden:!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(ue,{params:{supplier:e.pk}})},{name:"purchase-orders",label:t._({id:"85Yvr2"}),icon:s.jsx(L,{}),hidden:!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(me,{supplierId:e.pk})},{name:"stock-items",label:t._({id:"Jbck4N"}),icon:s.jsx(O,{}),hidden:!(e!=null&&e.is_manufacturer)&&!(e!=null&&e.is_supplier),content:(e==null?void 0:e.pk)&&s.jsx(M,{allowAdd:!1,tableName:"company-stock",params:{company:e.pk}})},{name:"sales-orders",label:t._({id:"B1TL+X"}),icon:s.jsx(U,{}),hidden:!(e!=null&&e.is_customer),content:(e==null?void 0:e.pk)&&s.jsx(_e,{customerId:e.pk})},{name:"return-orders",label:t._({id:"LlTg8M"}),icon:s.jsx(W,{}),hidden:!(e!=null&&e.is_customer),content:e.pk&&s.jsx(he,{params:{customer:e.pk}})},{name:"assigned-stock",label:t._({id:"TVGEcl"}),icon:s.jsx(Y,{}),hidden:!(e!=null&&e.is_customer),content:e!=null&&e.pk?s.jsx(M,{allowAdd:!1,tableName:"assigned-stock",params:{customer:e.pk}}):s.jsx(R,{})},{name:"contacts",label:t._({id:"gVfVfe"}),icon:s.jsx(H,{}),content:(e==null?void 0:e.pk)&&s.jsx(ke,{companyId:e.pk})},{name:"addresses",label:t._({id:"bYmAV1"}),icon:s.jsx(K,{}),content:(e==null?void 0:e.pk)&&s.jsx(fe,{companyId:e.pk})},{name:"attachments",label:t._({id:"w/Sphq"}),icon:s.jsx(Q,{}),content:s.jsx(de,{model_type:j.company,model_id:e.pk})},{name:"notes",label:t._({id:"1DBGsz"}),icon:s.jsx(z,{}),content:s.jsx(se,{modelType:j.company,modelId:e.pk,editable:a.hasChangeRole(r.purchase_order)||a.hasChangeRole(r.sales_order)||a.hasChangeRole(r.return_order)})}],[u,e,a]),c=w({url:i.company_list,pk:e==null?void 0:e.pk,title:t._({id:"HoG6cl"}),fields:ie(),onFormSuccess:h}),p=I({url:i.company_list,pk:e==null?void 0:e.pk,title:t._({id:"riHm27"}),onFormSuccess:h}),k=l.useMemo(()=>[s.jsx(Z,{model:j.company,pk:e.pk}),s.jsx(te,{tooltip:t._({id:"z+ZEYC"}),icon:s.jsx(V,{}),actions:[ae({hidden:!a.hasChangeRole(r.purchase_order),onClick:()=>c.open()}),oe({hidden:!a.hasDeleteRole(r.purchase_order),onClick:()=>p.open()})]})],[u,e,a]),x=l.useMemo(()=>[s.jsx($,{label:t._({id:"NoNwIX"}),color:"red",visible:e.active==!1})],[e]);return s.jsxs(s.Fragment,{children:[c.modal,p.modal,s.jsx(X,{status:_,loading:n.isFetching,children:s.jsxs(q,{gap:"xs",children:[s.jsx(re,{title:t._({id:"7i8j3G"})+`: ${e.name}`,subtitle:e.description,actions:k,imageUrl:e.image,breadcrumbs:m.breadcrumbs,badges:x,editAction:c.open,editEnabled:a.hasChangePermission(j.company)}),s.jsx(le,{pageKey:"company",panels:f})]})})]})}export{ts as default};
